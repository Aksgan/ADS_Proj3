icon and descriptive text to the drive icon. </li> <li> Checks to see if the {{keypress|[[Shift key|Shift]]}} key is held down. If it is then Windows Vista (and later Windows versions) will invoke the AutoPlay dialog regardless of settings to the contrary.<ref name=vista_ap_faq>[http://windowshelp.microsoft.com/Windows/en-us/help/7e1fe788-0747-4e00-895b-c3461b1ddd971033.mspx AutoPlay: frequently asked questions], Microsoft, ''Windows Vista Help''</ref> Previous versions of Windows will not continue with the process.<ref name=enadis/> </li> <li> Finally, if this point has been reached, either: * takes no further action. * executes the "AutoRun task", the application optionally specified in the <code>open</code> or <code>shellexecute</code> keys in an autorun.inf's [[autorun.inf#%5bautorun%5d|&#91;autorun&#93;]] section. * invokes AutoPlay. Which choice is made depends on the version of Windows in use, instructions from the autorun.inf if available and the type of the media discovered. </li> </ol> === Changing behaviour === {{See also|autorun.inf#Inf handling}} ==== Before AutoPlay ==== On Windows versions prior to Windows XP, an autorun.inf file on any drive type will be read and its instructions followed. The AutoRun task, if specified, is executed immediately without user interaction.<ref name=inftest>[http://support.microsoft.com/kb/136214 How to Test autorun.inf Files], Microsoft, ''Knowledge Base''</ref> This includes DRIVE_REMOVABLE, DRIVE_FIXED and DRIVE_REMOTE [[#Drive types|drive types]]. AutoRun will work with network drives (the DRIVE_REMOTE drive type) that are mapped to a drive letter. AutoRun will also work with floppy drives that are provided with autorun-compatible drivers.<ref name=enadis/> The default Registry settings on Windows versions prior to Windows XP (See [[#NoDriveTypeAutoRun|NoDriveTypeAutoRun]]), disable Remote and Removable drives from AutoRun initiation, leaving Fixed and CDROM drive types active by default. ==== Introducing AutoPlay ==== With the introduction of AutoPlay in Windows XP, the final stage action (stage 7 above) for some drive types changed from executing an application to invoking AutoPlay. From Windows Vista, the AutoPlay system is integrated into every aspect of media handling and there is no automatic execution of the AutoRun task. The default Registry settings add Removable drives to those that initiated AutoRun. In Windows XP and higher, ''except'' Windows Server 2003, only the Unknown and Remote drive types are not active for AutoRun. The handling of the autorun.inf file changes very significantly between each Windows version. The details can be found in the [[autorun.inf#Inf handling|autorun.inf]] article. The current handling in Windows 7 is that ''only'' drives of type DRIVE_CDROM may specify an AutoRun task, alter double-click behaviour or change context menus. === The AutoPlay safety net === It would appear that AutoPlay, by transferring control of what were previously automatic and invisible actions to AutoPlay, acts to increase user control and safety. This applies especially from Windows Vista, where all media and devices fall under AutoPlay control. However, it is important to note that: * A user can instruct AutoPlay to make automatic choices on their behalf, including the execution of any AutoRun task. * When a user double clicks on the drive icon in Explorer or right clicks to get a context menu, what happens next is fully programmable by the autorun.inf file and is essentially outside AutoPlay's purview. This is true under any Windows operating system. * Disabling AutoRun may force a user to double click the drive icon to get a contents list, thus actually increasing the chance of malware infiltration. == Registry settings == AutoRun consults [[Windows Registry]] values to decide whether to initiate actions for any particular drive or drive type. These values can be changed using several methods, one of which is using [[Group policy|Group Policy]]. The primary relevant Registry entry names are <tt>NoDriveTypeAutoRun</tt> and <tt>NoDriveAutoRun</tt>. These exist in both per-machine and per-user settings and their location and priority in the Registry are described in further detail below. === Drive types === The drive types are distinguished by Type Name as follows:<ref>[http://msdn.microsoft.com/en-us/library/aa364939.aspx GetDriveType Function], Microsoft, ''MSDN Library''</ref> {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- ! Type name !! Description |- | DRIVE_UNKNOWN || The drive type cannot be determined |- | DRIVE_REMOVABLE || The drive has removable media (floppy drive, [[USB flash drive]]) |- | DRIVE_FIXED || The disk cannot be removed from the drive (hard disk) |- | DRIVE_REMOTE || The drive is a remote (network) drive |- | DRIVE_CDROM || The drive is a CD-ROM or DVD-ROM drive |- | DRIVE_RAMDISK || The drive is a [[RAM disk]] |} === Registry terminology === <!-- I was torn over whether any of this was necessary given the existence of the Windows Registry article but I decided to do it anyway. I may make some additions to the registry article and remove this section at a later date. Carveone. --> The Windows Registry is a hierarchical [[directory (database)|database]] that stores configuration settings and options for the operating system. The terminology is somewhat misleading so it is briefly summarised here. A Registry ''key'' is similar to a folder that, in addition to values, each key can contain subkeys which in turn may contain subkeys, and so on. A Registry ''value'' consists of a name-data pair. Microsoft documentation commonly uses the term "entry" as an equivalent term. It also uses "value" for "data" when it is obvious what is meant. To avoid confusion, this article always uses the term "entry" when referring to the name-data pair. Two Registry keys that are very commonly referred to are <tt>HKEY_LOCAL_MACHINE</tt> which contains per-machine settings, and <tt>HKEY_CURRENT_USER</tt> which contains settings for the currently logged-on user. These are almost always abbreviated as <tt>HKLM</tt> and <tt>HKCU</tt> respectively. There may be many users of a machine; their settings are stored in <tt>HKEY_USERS</tt>, <tt>HKCU</tt> is actually just a link to the appropriate place in <tt>HKEY_USERS</tt>. === Changing Registry settings === Registry settings may be changed directly by using the GUI <tt>regedit</tt> tool or the command line <tt>reg.exe</tt> utility. Settings can also be placed in a [[#Registry files|text file]],<ref name=kb310516>[http://support.microsoft.com/kb/310516 How to use a registration entries file], Microsoft, ''Knowledge Base''</ref> named with a .reg extension type. For example, "<tt>mychanges.reg</tt>". When the file is double clicked, the settings in the file are entered into the Registry, permissions allowing. They can be changed indirectly by using Group Policy, applied locally to a single 