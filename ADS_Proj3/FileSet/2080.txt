length is set to zero when a ''Hop-by-Hop'' extension header carries a [[#Jumbogram|Jumbo Payload]] option.<ref name=rfc2675>Borman, D.; [[Steve Deering|Deering, S.]]; Hinden, R. (August 1999). ''[http://tools.ietf.org/html/rfc2675 IPv6 Jumbograms]''. [[Internet Engineering Task Force|IETF]]. RFC{{nbsp}}2675.</ref> ; ''Next Header'' (8 bits) : Specifies the type of the next header. This field usually specifies the [[transport layer]] protocol used by a packet's payload. When extension headers are present in the packet this field indicates which extension header follows. The values are [[List of IP protocol numbers|shared]] with those used for the IPv4 protocol field, as both fields have the same function (see [[List of IP protocol numbers]]). ; ''Hop Limit'' (8 bits) : Replaces the [[time to live]] field of IPv4. This value is decremented by one at each intermediate node the packet visits. When the counter reaches 0 the packet is discarded. ; ''Source Address'' (128 bits) : The [[IPv6 address]] of the sending node. ; ''Destination Address'' (128 bits) : The IPv6 address of the destination node(s). The header has no [[checksum]] to protect it in order to increase [[routing]] speeds, and since current [[link layer]] technology is assumed to provide sufficient error detection.<ref name=rfc2460/><ref name=rfc1726>Partridge C., Kastenholz F. (Dec. 1994). ''[http://tools.ietf.org/html/rfc1726 Technical Criteria for Choosing IP The Next Generation (IPng)]''. [[Internet Engineering Task Force|IETF]]. RFC{{nbsp}}1726.</ref> Higher-level protocols are responsible to discard mis-addressed packets.<ref name=rfc1726/> ==Extension headers== Extension headers carry optional [[Internet Layer]] information, and are placed between the fixed header and the upper-layer protocol header.<ref name=rfc2460 /> The headers form a chain, using the ''Next Header'' fields. The ''Next Header'' field in the fixed header indicates the type of the first extension header; the ''Next Header'' field of the last extension header indicates the type of the upper-layer protocol header in the payload of the packet. All extension headers are a multiple of 8 octets in size; some extension headers require internal padding to meet this requirement. There are several extension headers defined,<ref name=rfc2460 /> and new extension headers may be defined in the future. Extension headers are to be examined and processed at the packet's destination only, except for ''Hop-by-Hop Options'', which need to be processed at every intermediate node on the packet's path, including sending and receiving node. The defined extension headers below are listed in the preferred order, should there be more than one extension header following the fixed header. Note that all extension headers are optional and should only appear at most once, except for the ''Destination Options'' header, which may appear twice. If a node does not recognize a specific extension header, it should discard the packet and send an ''Parameter Problem'' message ([[ICMPv6]] type 4, code 1).<ref name=rfc2460 /> When a Next Header value <tt>0</tt> appears in a header other than the fixed header a node should do the same. :{| class="wikitable" <!-- Listed in order as recommended by RFC2460 --> |- ! Extension Header ! [[List of IP protocol numbers|Type]] ! Description |- | ''Hop-by-Hop Options'' | | 0 || Options that need to be examined by all devices on the path. |- | ''Destination Options'' (before routing header) <!-- May appear twice in the chain of headers. --> | | 60 || Options that need to be examined only by the destination of the packet. |- | ''Routing'' | | 43 || Methods to specify the route for a datagram (used with [[Mobile IPv6]]). |- | ''Fragment'' | | 44 || Contains parameters for fragmentation of datagrams. |- | ''Authentication Header (AH)'' | | 51 || Contains information used to verify the authenticity of most parts of the packet. |- | ''Encapsulating Security Payload (ESP)'' | | 50 || Carries encrypted data for secure communication. |- | ''Destination Options'' (before upper-layer header) <!-- May appear twice in the chain of headers. --> | | 60 || Options that need to be examined only by the destination of the packet. |} Value 59 (No Next Header) in the Next Header field indicates that there is no next header ''whatsoever'' following this one, not even a header of an upper-layer protocol. It means that, from the header's point of view, the IPv6 packet ends right after it: the payload should be empty.<ref name=rfc2460/> There could, however, still be data in the payload if the payload length in the first header of the packet is greater than the length of all extension headers in the packet. This data should be ignored by hosts, but passed unaltered by routers. ===Hop-by-hop options and destination options=== The ''Hop-by-Hop Options'' extension header needs to be examined by all nodes on the packet's path, including sending and receiving nodes. The ''Destination Options'' extension header need to be examined by the destination node(s) only. The extension headers are both at least 8 octets in size; if more options are present than will fit in that space, blocks of 8 octets are added to the header repeatedly—containing options and padding—until all options are represented. :{| class="wikitable" style="text-align: center" |+''Hop-by-Hop Options'' and ''Destination Options'' extension header format |- ! style="border-bottom:none; border-right:none;"| ''Offsets'' ! style="border-left:none;"| Octet ! colspan="8" | 0 ! colspan="8" | 1 ! colspan="8" | 2 ! colspan="8" | 3 |- ! style="border-top: none" | Octet ! Bit ! style="width:2.6%;"| 0 ! style="width:2.6%;"| 1 ! style="width:2.6%;"| 2 ! style="width:2.6%;"| 3 ! style="width:2.6%;"| 4 ! style="width:2.6%;"| 5 ! style="width:2.6%;"| 6 ! style="width:2.6%;"| 7 ! style="width:2.6%;"| 8 ! style="width:2.6%;"| 9 ! style="width:2.6%;"| 10 ! style="width:2.6%;"| 11 ! style="width:2.6%;"| 12 ! style="width:2.6%;"| 13 ! style="width:2.6%;"| 14 ! style="width:2.6%;"| 15 ! style="width:2.6%;"| 16 ! style="width:2.6%;"| 17 ! style="width:2.6%;"| 18 ! style="width:2.6%;"| 19 ! style="width:2.6%;"| 20 ! style="width:2.6%;"| 21 ! style="width:2.6%;"| 22 ! style="width:2.6%;"| 23 ! style="width:2.6%;"| 24 ! style="width:2.6%;"| 25 ! style="width:2.6%;"| 26 ! style="width:2.6%;"| 27 ! style="width:2.6%;"| 28 ! style="width:2.6%;"| 29 ! style="width:2.6%;"| 30 ! style="width:2.6%;"| 31 |- ! 0 ! 0 | colspan="8"|''Next Header | colspan="8"|''Hdr Ext Len | colspan="16"|''Options and Padding'' |- ! 4 ! 32 | colspan="32"|''Options and Padding'' |- ! 8 ! 64 | colspan="32" rowspan=2|Optional: more ''Options and Padding'' ... |- ! 