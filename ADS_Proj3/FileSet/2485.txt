Navier-Stokes Equation from Discrete LBE== Starting with the discrete lattice Boltzmann equation (also referred to as LBGK equation due to the collision operator used). We first do a <math>2^{nd}\,\!</math> order Taylor series expansion about the left side of the LBE. This is chosen over a simpler <math>1^{st}\,\!</math> order Taylor expansion as the discrete LBE cannot be recovered. When doing the <math>2^{nd}\,\!</math> order Taylor series expansion, the zero derivative term and the first term on the right will cancel leaving only the first and second derivative terms of the Taylor expansion and the collision operator. <math>f_i(\vec{x}+\vec{e}_i\delta_t,t+\delta_t) = f_i(\vec{x},t) + \frac{1}{\tau_f} (f_i^{eq}-f_i)</math> For simplicity, write <math>f_i(\vec{x},t)</math> as <math>f_i\,\!</math>. The slightly simplified Taylor series expansion is then as follows where ":" is the colon product between dyads. :<math>\frac{\part f_i}{\part t} +\vec{e}_i \nabla f_i+K \left (\frac{1}{2}\vec{e}_i\vec{e}_i : \nabla\nabla f_i +\vec{e}_i\cdot\nabla\frac{\part f_i}{\part t} +\frac{1}{2}\frac{\part^2 f_i}{\part t^2} \right ) =\frac{1}{K \tau}(f_i^{eq}-f_i) </math> By expanding the particle distribution function into equilibrium and non-equilibrium components and using the Chapman-Enskog Expansion where <math>K\,\!</math> is the Knudsen number, the Taylor expanded LBE can be decomposed into different magnitudes of order for the Knudsen number in order to obtain the proper continuum equations. :<math>f_i=f_i^{eq}+K f_i^{neq}\,\!</math> :<math>f_i^{neq}= f_i^{(1)}+K f_i^{(2)}+O(K^2) \qquad s.t.\ k=1,2\,\!</math> The equilibrium and non-equilibrium distributions satisfy the following relations to their macroscopic variables. These will be used later once the particle distributions are in the 'correct form' in order to scale from the particle to macroscopic level. :<math>\rho = \sum_i f_i^{eq} </math> :<math>\rho \vec{u} = \sum_i f_i^{eq} \vec{e}_i</math> :<math>0 = \sum_i f_i^{(k)} </math> :<math>0 = \sum_i f_i^{(k)} \vec{e}_i</math> The Chapman-Enskog Expansion is then: :<math>\frac{\part}{\part t}=K\frac{\part}{\part t_1}+K^2\frac{\part}{\part t_2} \qquad s.t.\ t_2(diffusive\ time-scale) <<t_1(convective\ time-scale) </math> :<math>\frac{\part}{\part x}=K\frac{\part}{\part x_1}</math>. By substituting the expanded equilibirum and non-equilibrium into the Taylor expansion and separating into different orders of <math>K\,\!</math>, the continuum equations are nearly derived. For order, <math>K^0\,\!</math>: :<math>\frac{\part f_i^{eq}}{\part t_1} +\vec{e}_i \nabla_1 f_i^{eq} =-\frac{f_i^{(1)}}{\tau} </math> For order, <math>K^1\,\!</math>: :<math>\frac{\part f_i^{(1)}}{\part t_1}+\frac{\part f_i^{eq}}{\part t_2} +\vec{e}_i \nabla f_i^{(1)}+ \frac{1}{2}\vec{e}_i\vec{e}_i : \nabla\nabla f_i^{eq} +\vec{e}_i\cdot\nabla\frac{\part f_i^{eq}}{\part t_1} +\frac{1}{2}\frac{\part^2 f_i^{eq}}{\part t_1^2} =\frac{f_i^{(2)}}{\tau} </math> Then, the second equation can be simplified with some algebra and the first equation into the following. :<math>\frac{\part f_i^{(1)}}{\part t_2} +\left ( 1-\frac{2}{\tau} \right ) \left [ \frac{\part f_i^{(1)}}{\part t_1}+\vec{e}_i \nabla_1 f_i^{(1)}\right ] =-\frac{f_i^{(2)}}{\tau} </math> Applying the relations between the particle distribution functions and the macroscopic properties from above, the mass and momentum equations are achieved. :<math>\frac{\rho}{\part t} +\nabla \cdot \rho \vec{u} = 0 </math> :<math>\frac{\rho\vec{u}}{\part t} +\nabla \cdot \Pi = 0 </math> The momentum flux tensor, <math>\Pi\,\!</math>, has the following form then. :<math> \Pi_{xy} = \sum_{i}\vec{e}_{ix}\vec{e}_{iy}\left[ f_i^{eq} + \left( 1 - \frac{1}{2 \tau} \right) f_i^{(1)} \right] \,\!</math> Where the equilibrium particle distribution with second order in order to be comprable to the Navier Stokes equation is: <math>f_i^{eq}=\omega_i\rho \left (1+\frac{3\vec{e}_i\vec{u}}{c^2}+\frac{9(\vec{e}_i\vec{u})^2}{2c^4}- \frac{3(\vec{u})^2}{2c^2} \right) </math>. The equilibirum distribution is only valid for small velocities or small Mach numbers. Inserting the equilibrium distribution back into the flux tensor leads to: :<math> \Pi_{xy}^{(0)} = \sum_{i}\vec{e}_{ix}\vec{e}_{iy} f_i^{eq} =p\delta_{xy}+\rho u_x u_y \,\!</math> :<math> \Pi_{xy}^{(1)} =\left( 1 - \frac{1}{2 \tau} \right) \sum_{i}\vec{e}_{ix}\vec{e}_{iy} f_i^{(1)} =\nu\left(\nabla_x \left( \rho \vec{u}_y \right) +\nabla_y \left( \rho \vec{u}_x \right)\right)\,\!</math> Finally, the Navier-Stokes equation is recovered under the assumption that density variation is small. :<math> \rho \left( \frac{\part \vec{u}_{x}}{\part t} + \nabla_{y}\cdot\vec{u}_{x}\vec{u}_{y}\right)= -\nabla_{x}p+\nu\nabla_{y}\cdot\left(\nabla_x \left( \rho \vec{u}_y \right) +\nabla_y \left( \rho \vec{u}_x \right)\right) \,\!</math> This derivation follows the work of Chen and Doolen.<ref>Chen, S., and Doolen, G.D., "Lattice Boltzmann Method for Fluid Flows", Annual Review of Fluid Mechanics, vol. 30, pp. 329-364, 1998.</ref> ==Mathematical Equations for Simulations== The continuous Boltzmann equation is an evolution equation for a single particle probability distribution function <math>f(\vec{x},\vec{e}_i,t)\,\!</math> and the internal energy density distribution function <math>g(\vec{x},\vec{e}_i,t)\,\!</math> (He et al.) are each respectively: :<math>\partial_t f + (\vec{e}\cdot \nabla) f + F\partial_v f=\Omega(f)</math> :<math>\partial_t g + (\vec{e}\cdot \nabla) g + G\partial_v f=\Omega(g)</math> where <math>g(\vec{x},\vec{e}_i,t)\,\!</math> is related to <math>f(\vec{x},\vec{e}_i,t)\,\!</math> by: <math>g(\vec{x},\vec{e}_i,t) = \frac{(\vec{e}-\vec{u})^2}{2}f(\vec{x},\vec{e}_i,t)</math> <math>F\,\!</math> is an external force, <math>\Omega\,\!</math> is a collision integral, and <math>\vec{e}</math> (also labeled by <math>\vec{\xi}</math> in literature) is the microscopic velocity. The external force, <math>F\,\!</math>, is related to temperature external force <math>G\,\!</math> by the relation below. A typical test for one's model is the [[Rayleigh-BÃ©nard convection]] for <math>G\,\!</math>. :<math> F = \frac{\vec{G}\cdot(\vec{e}-\vec{u})}{RT}f^{eq} </math> :<math> \vec{G} = \beta g_0(T-T_{avg})\vec{k} </math> Macroscopic variables such as density <math>\rho\,\!</math>, velocity <math>\vec{u}\,\!</math>, and temperature <math>T\,\!</math> can be calculated as the moments of the density distribution function: :<math> \rho = \int\ f \, d\vec{e} </math> :<math> \rho\vec{u} = \int\ \vec{e}f \, d\vec{e} </math> :<math> \frac{\rho DRT}{2} = \rho\epsilon = \int\ g \, d\vec{e} </math> The lattice Boltzmann method discretizes this equation by limiting space to a lattice and the velocity space to a discrete set of microscopic velocities (i.e. <math>\vec{e}_i = (\vec{e}_{ix},\vec{e}_{iy})</math>). The microscopic velocities in D2Q9, D3Q15, and D3Q19 for example are given as: <math>\vec{e}_i = c\times \begin{cases} (0,0) & i = 0 \\ (1,0),(0,1),(-1,0),(0,-1) & i = 1,2,3,4 \\ (1,1),(-1,1),(-1,-1),(1,-1) & i = 5,6,7,8 \\ \end{cases}</math> <math>\vec{e}_i = c\times \begin{cases} (0,0) & i = 0 \\ (\plusmn 1,0,0),(0,\plusmn 1,0),(0,0,\plusmn 1) & i = 1,2,...,5,6 \\ (\plusmn1,\plusmn1,\plusmn1) & i = 7,8,...,13,14 \\ \end{cases}</math> <math>\vec{e}_i = c\times \begin{cases} (0,0) & i = 0 \\ (\plusmn 1,0,0),(0,\plusmn 1,0),(0,0,\plusmn 1) & i = 1,2,...,5,6 \\ (\plusmn1,\plusmn1,0),(\plusmn1,0,\plusmn1),(0,\plusmn1,\plusmn1) & i = 7,8,...,17,18 \\ \end{cases}</math> The single phase discretized Boltzmann equation for mass density and internal energy density are: :<math>f_i(\vec{x}+\vec{e}_i\delta_t,t+\delta_t)-f_i(\vec{x},t) + F_i=\Omega(f)</math> :<math>g_i(\vec{x}+\vec{e}_i\delta_t,t+\delta_t)-g_i(\vec{x},t) + G_i=\Omega(g)</math> The collision operator is often approximated by a BGK collision operator under the condition it also satisfies the conservation laws. :<math>\Omega(f) = \frac{1}{\tau_f} (f_i^{eq}-f_i)</math> :<math>\Omega(g) = \frac{1}{\tau_g} (g_i^{eq}-g_i)</math> In the collision operator, <math>f_i^{eq}</math> is the discrete, equilibrium particle probability distribution function. In D2Q9 and D3Q19, it is shown below for an incompressible flow in continuous and discrete form where D, R, and T are the dimension, universal gas constant, and absolute temperature respectively. The partial derivation for the continuous to discrete form is provided through a simple derivation to second order accuracy. :<math>f^{eq}=\frac{\rho}{(2 \pi RT)^{D/2}}e^{-\frac{(\vec{e}-\vec{u})^2}{2RT}} </math> :<math>=\frac{\rho}{(2 \pi RT)^{D/2}}e^{-\frac{(\vec{e})^2}{2RT}}e^{\frac{\vec{e}\vec{u}}{RT}-\frac{\vec{u}^2}{2RT}} </math> :<math>=\frac{\rho}{(2 \pi RT)^{D/2}}e^{-\frac{(\vec{e})^2}{2RT}}(1+\frac{\vec{e}\vec{u}}{RT}+\frac{(\vec{e}\vec{u})^2}{2(RT)^2}-\frac{\vec{u}^2}{2RT}+...) </math> Letting <math>c=\sqrt{3RT}\,\! </math> yields the final result. :<math>f_i^{eq}=\omega_i\rho \left (1+\frac{3\vec{e}_i\vec{u}}{c^2}+\frac{9(\vec{e}_i\vec{u})^2}{2c^4}- \frac{3(\vec{u})^2}{2c^2} \right) </math> :<math>g^{eq}=\frac{\rho(\vec{e}-\vec{u})^2}{2(2 \pi RT)^{D/2}}e^{-\frac{(\vec{e}-\vec{u})^2}{2RT}} 