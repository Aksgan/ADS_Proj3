[[Image:PlusCM128.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] |- ! Photon polarization Alice sends | [[Image:Arrow north.svg|20x20px]] || [[Image:Arrow east.svg|20x20px]] || [[Image:Arrow southeast.svg|15x15px]] || [[Image:Arrow north.svg|20x20px]] || [[Image:Arrow southeast.svg|15x15px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow east.svg|20x20px]] |- ! Eve's random measuring basis | [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] |- ! Polarization Eve measures and sends | [[Image:Arrow north.svg|20x20px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow east.svg|20x20px]] || [[Image:Arrow north.svg|20x20px]] || [[Image:Arrow southeast.svg|15x15px]] || [[Image:Arrow east.svg|20x20px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow east.svg|20x20px]] |- ! Bob's random measuring basis | [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:Multiplication Sign.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] || [[Image:PlusCM128.svg|15x15px]] |- ! Photon polarization Bob measures | [[Image:Arrow north.svg|20x20px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow southeast.svg|15x15px]] || [[Image:Arrow east.svg|20x20px]] || [[Image:Arrow northeast.svg|15x15px]] || [[Image:Arrow north.svg|20x20px]] || [[Image:Arrow east.svg|20x20px]] |- ! PUBLIC DISCUSSION OF BASIS | colspan=8 | |- ! Shared secret key | 0 || || 0 || || || 0 || || 1 |- ! Errors in key | {{unicode|✓}} || || {{unicode|✘}} || || || {{unicode|✓}} || || {{unicode|✓}} |} The probability Eve chooses the incorrect basis is 50% (assuming Alice chooses randomly), and if Bob measures this intercepted photon in the basis Alice sent he gets a random result, i.e., an incorrect result with probability of 50%. The probability an intercepted photon generates an error in the key string is then 50% × 50% = 25%. If Alice and Bob publicly compare <math>n</math> of their key bits (thus discarding them as key bits, as they are no longer secret) the probability they find disagreement and identify the presence of Eve is <center><math>P_d = 1 - \left(\frac{3}{4}\right)^n</math></center> So to detect an eavesdropper with probability <math>P_d = 0.999999999</math> Alice and Bob need to compare <math>n = 72</math> key bits. === Security Proofs === The above is just a simple example of an attack. If Eve is assumed to have unlimited resources, for example classical and quantum computing power, there are many more attacks possible. BB84 has been proven secure against any attacks allowed by quantum mechanics, both for sending information using an ideal photon source which only ever emits a single photon at a time,<ref>P. W. Shor and J. Preskill, Physical Review Letters 85, 441 (2000)</ref> and also using practical photon sources which sometimes emit multiphoton pulses.<ref name="GLLP">D. Gottesman, H.-K. Lo, N. L¨utkenhaus, and J. Preskill, Quant. Inf. Comp. 4, 325 (2004)</ref> These proofs are unconditionally secure in the sense that no conditions are imposed on the resources available to the Eavesdropper, however there are other conditions required: # Eve cannot access Alice and Bob's encoding and decoding devices. # The random number generators used by Alice and Bob must be trusted and truly random (for example a [[Hardware random number generator|Quantum random number generator]]). # The classical communication channel must be authenticated using an [[Man-in-the-middle attack#Quantum cryptography|unconditionally secure authentication]] scheme. # The message must be sent encrypted by correctly used [[one-time pad]] (unconditionally secure encryption) scheme. === Man-in-the-middle attack === Quantum key distribution is vulnerable to a [[man-in-the-middle attack]] when used without authentication to the same extent as any classical protocol, since no known principle of quantum mechanics can distinguish friend from foe. As in the classical case, Alice and Bob cannot authenticate each other and establish a secure connection without some means of verifying each other's identities (such as an initial shared secret). If Alice and Bob have an initial shared secret then they can use an unconditionally secure authentication scheme (such as [[Carter-Wegman MAC|Carter-Wegman]],<ref>M. N. Wegman and J. L. Carter, "New hash functions and their use in authentication and set equality, Journal of Computer and System Sciences", 22, pp 265-279, (1981)</ref>) along with quantum key distribution to exponentially expand this key, using a small amount of the new key to authenticate the next session.<ref>Romain Alleaume, et al. "SECOQC White Paper on Quantum Key Distribution and Cryptography" arXiv:quant-ph/0701168v1 pp. 7 (2007) ([http://arxiv.org/abs/quant-ph/0701168])</ref> Several methods to create this initial shared secret have been proposed, for example using a 3rd party<ref>Z. Zhang, J. Liu, D. Wang and S. Shi “Quantum direct communication with authentication” Phys. Rev. A 75, 026301 (2007)</ref> or chaos theory.<ref>D. Huang, Z. Chen, Y. Guo and M. Lee "Quantum Secure Direct Communication Based on Chaos with Authentication", Journal of the Physical Society of Japan Vol. 76 No. 12, 124001 (2007) ([http://jpsj.ipap.jp/link?JPSJ/76/124001/])</ref> Nevertheless only "almost strongly universal" family of hash functions can be used for unconditionally secure authentication<ref>http://www.lysator.liu.se/~jc/mthesis/5_Unconditionally_secure_au.html</ref>. === Photon number splitting attack === In the [[BB84]] protocol Alice sends quantum states to Bob using single photons. In practice many implementations use laser pulses attenuated to a very low level to send the quantum states. These laser pulses contain a very small number of photons, for example 0.2 photons per pulse, which are distributed according to a [[Poissonian distribution]]. This means most pulses actually contain no photons (no pulse is sent), some pulses contain 1 photon (which is desired) and a few pulses contain 2 or more photons. If the pulse contains more than one photon, then Eve can split off the extra photons and transmit the remaining single photon to Bob. This is the basis of the photon number splitting attack,<ref>G. Brassard, N. Lütkenhaus, T. Mor, and B. C. Sanders. "Limitations on practical quantum cryptography." Physical Review Letters, 85(6):1330+ (2000)</ref> where Eve stores these extra photons in a quantum memory until Bob detects the remaining single photon and Alice reveals the encoding basis. Eve can then measure her photons in the correct basis and obtain information on the key without introducing detectable errors. Even with the possibility of a PNS attack a secure key can still be generated, as shown in the GLLP security proof,<ref name="GLLP" /> however a much higher amount of privacy amplification is needed reducing the secure key rate significantly (with PNS the rate scales as <math>t^2</math> as compared to 