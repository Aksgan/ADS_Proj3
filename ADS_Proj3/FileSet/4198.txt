used in the Srizbi trojan is very similar to the code found in the Rustock trojan, and could well be an improved version of the latter.<ref name="kernelspam">{{cite news | last = Hayashi | first = Kaoru| title ="Spam from the Kernel: Full-Kernel Malware Installed by MPack" | publisher = Symantec | date = June 29, 2007 | url = https://forums.symantec.com/syment/blog/article?message.uid=305311 | accessdate = 2008-07-20}}</ref> === Srizbi trojan === The Srizbi trojan is the [[client side]] program responsible for sending the spam from infected machines. The [[trojan horse (computing)|trojan]] has been credited with being extremely efficient at this task, which explains why Srizbi is capable of sending such high volumes of spam without having a huge numerical advantage in the number of infected computers. Apart from having an efficient spam engine, the trojan is also very capable in hiding itself from both the user and the system itself, including any products designed to remove the trojan from the system. The trojan itself is fully executed in [[kernel mode]] and has been noted to employ [[rootkit]] technologies to prevent any form of detection.<ref>{{cite news|publisher=[[The Register]]|accessdate=2009-02-10|date=2009-02-11|url=http://www.theregister.co.uk/2009/02/11/patch_tuesday_roundup/|title=Microsoft takes scissors to Srizbi|author=Dan Goodin|location=San Francisco}}</ref> By patching the [[NTFS]] [[file system]] [[device driver|driver]]s, the trojan will make its files invisible for both the [[operating system]] and any human user utilizing the system. The trojan is also capable of hiding [[network traffic]] it generates by directly attaching [[NDIS]] and [[TCP/IP]] drivers to its own process, a feature currently unique for this trojan. This procedure has been proven to allow the trojan to bypass both [[firewall (computer)|firewall]] and [[Packet analyzer|sniffer]] protection on the system.<ref name="kernelspam"/> Once the bot is in place and operational, it will contact one of the [[hardcoded]] [[Server (computing)|server]]s from a list it carries with it. This server will then supply the bot with a [[ZIP (file format)|zip]] file containing a number of files required by the bot to start its spamming business. The following files have been identified to be downloaded: # <code>000_data2</code> - mail server domains # <code>001_ncommall</code> - list of names) # <code>002_senderna</code> - list of possible sender names # <code>003_sendersu</code> - list of possible sender surnames # <code>config</code> - Main spam configuration file # <code>message</code> - HTML message to spam # <code>mlist</code> - Recipients mail addresses # <code>mxdata</code> - MX record data When these files have been received, the bot will first initialize a software routine which allows it to remove files critical for revealing [[Spam (electronic)|spam]] and [[rootkit]] applications. <ref name="kernelspam"/> After this procedure is done, the trojan will then start sending out the spam message it has received from the control server. == Incidents == The Srizbi botnet has been the basis for several incidents which have received media coverage. Several of the most notable ones will be described below here. This is by no means a complete list of incidents, but just a list of the major ones. === The "Ron Paul" incident === In October 2007, several [[anti-spam]] firms noticed an unusual [[E-mail spam|spam]] campaign emerging. Unlike the usual messages about counterfeit watches, stocks, or penis enlargement, the mail contained promotional information about [[United States]] [[presidential candidate]] [[Ron Paul]]. The [[Ron Paul]] camp dismissed the [[E-mail spam|spam]] as being not related to the official presidential campaign. A spokesman told the press: "If it is true, it could be done by a well-intentioned yet misguided supporter or someone with bad intentions trying to embarrass the campaign. Either way, this is independent work, and we have no connection."<ref name="ronpaul">{{cite news | last = Cheng | first = Jacqui| title = Researchers: Ron Paul campaign e-mails originating from spambots | publisher = ARS Technica| date = October 31, 2007 | url = http://arstechnica.com/news.ars/post/20071031-ron-paul-camp-gets-over-enthusiastic-with-spam.html | accessdate = 2008-07-20}}</ref> The spam was ultimately confirmed as having come from the Srizbi network.<ref name="ronpaultrace">{{cite news | last = Paul| first = Ryan| title = Researchers track Ron Paul spam back to Reactor botnet | publisher = ARS Technica| date = December 6, 2007 | url = http://arstechnica.com/news.ars/post/20071206-researchers-track-ron-paul-spam-back-to-reactor-botnet.html | accessdate = 2008-07-20}}</ref> Through the capture of one of the control servers involved,<ref name="secuworks"/> investigators learned that the spam message had been sent to up to 160 million [[e-mail]] addresses by as few as 3,000 bot computers. The spammer has only been identified by his Internet [[User (computing)|handle]] "nenastnyj" (''Ненастный'', means "rainy" or "foul", as in "rainy day, foul weather" in Russian); his or her real identity has not been determined. === Malicious spam tripling volumes in a week === In the week from 20 June 2008 Srizbi managed to triple the amount of malicious spam sent from an average 3% to 9.9%, largely due to its own effort.<ref>{{cite news | last = Salek| first = Negar| title = One of the biggest threats to Internet users today: Srizbi | publisher = SC Magazine| date = June 25, 2008 | url = http://www.securecomputing.net.au/News/115170,one-of-the-biggest-threats-to-internet-users-today-srizbi.aspx | accessdate = 2008-07-20}}</ref> This particular spam wave was an aggressive attempt to increase the size of the Srizbi botnet by sending e-mails to users which warned them that they had been videotaped naked.<ref>{{cite news | title = The Naked Truth About the Srizbi Botnet | publisher = Protect Web Form Blog| date = May 19, 2008 | url = http://blog.protectwebform.com/p/45 | accessdate = 2008-07-20}}</ref> Sending this message, which is a kind of spam referred to as "Stupid Theme", was an attempt to get people to click the malicious link included in the mail, before realizing that this message was most likely [[Spam (electronic)|spam]]. While old, this [[social engineering (security)|social engineering]] technique remains a proven method of infection for spammers. The size of this operation shows that the power and monetary income from a botnet is closely based upon its spam capacity: more infected computers translate directly into greater revenue for the botnet controller. It also shows the power botnets have to increase their own size, mainly by using a part of their own strength in numbers.<ref name=tripspam>{{cite news | last = Walsh| first = Sue| title = Spam Volume Triples In A 