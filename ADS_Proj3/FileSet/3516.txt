of an ICMP packet<ref name=rfc792>RFC 792</ref> * Header (in blue): ** ''Protocol'' set to 1 and ''Type of Service'' set to 0. * Payload (in red): ** Type of ICMP message (8 bits) ** Code (8 bits) ** Checksum (16 bits), calculated with the ICMP part of the packet (the header is not used). It is the 16-bit one's complement of the one's complement sum of the ICMP message starting with the Type field<ref name=networksorcery>{{cite web | title=RFC Sourcebook's page on ICMP | url=http://www.networksorcery.com/enp/protocol/icmp.htm#ICMP%20Header%20Checksum | accessdate=20 December 2010 }}</ref> ** The ICMP 'Quench' (32 bits) field, which in this case (ICMP echo request and replies), will be composed of identifier (16 bits) and sequence number (16 bits). ** Data load for the different kind of answers (Can be an arbitrary length, left to implementation detail. However must be less than the maximum MTU of the network {{Citation needed|date=December 2008}}). * Data Transportation ==Sample ping test== The following is a sample output of pinging <tt>en.wikipedia.org</tt> under [[Linux]] with the iputils version of ping: <pre> admin@localhost# ping en.wikipedia.org PING rr.pmtpa.wikimedia.org (66.230.200.100) 56(84) bytes of data. 64 bytes from rr.pmtpa.wikimedia.org (66.230.200.100): icmp_seq=1 ttl=52 time=87.7 ms 64 bytes from rr.pmtpa.wikimedia.org (66.230.200.100): icmp_seq=2 ttl=52 time=95.6 ms 64 bytes from rr.pmtpa.wikimedia.org (66.230.200.100): icmp_seq=3 ttl=52 time=85.4 ms 64 bytes from rr.pmtpa.wikimedia.org (66.230.200.100): icmp_seq=4 ttl=52 time=95.8 ms 64 bytes from rr.pmtpa.wikimedia.org (66.230.200.100): icmp_seq=5 ttl=52 time=87.0 ms 64 bytes from rr.pmtpa.wikimedia.org (66.230.200.100): icmp_seq=6 ttl=52 time=97.6 ms --- rr.pmtpa.wikimedia.org ping statistics --- 10 packets transmitted, 10 received, 0% packet loss, time 8998ms rtt min/avg/max/mdev = 78.162/89.213/97.695/6.836 ms </pre> The output shows the results of 10 pings to 66.230.200.100 with the results summarized at the end. The program is stopped by pressing [[Ctrl-C]]. * shortest [[round-trip delay time|round trip time]] was 78.162 milliseconds * average round trip time was 89.213 milliseconds * maximum round trip time was 97.695 milliseconds * [[Standard deviation]] of the round-trip time was 6.836 milliseconds ==Message format== ===Echo request=== The ''echo request'' is an [[Internet Control Message Protocol|ICMP]] message whose data is expected to be received back in an ''echo reply'' ("ping"). The host must respond to all echo requests with an echo reply containing the exact data received in the request message. {| class="wikitable" ! 00 || 01 || 02 || 03 || 04 || 05 || 06 || 07 ! 08 || 09 || 10 || 11 || 12 || 13 || 14 || 15 ! 16 || 17 || 18 || 19 || 20 || 21 || 22 || 23 ! 24 || 25 || 26 || 27 || 28 || 29 || 30 || 31 |- |colspan="8" align="center"| Type = 8 |colspan="8" align="center"| Code = 0 |colspan="16" align="center"| Header Checksum |- |colspan="16" align="center"| Identifier |colspan="16" align="center"| Sequence Number |- |colspan="32" align="center"| Data ::: |} *The Identifier and Sequence Number can be used by the client to match the reply with the request that caused the reply. In practice, most Linux systems use a unique identifier for every ping process, and sequence number is an increasing number within that process. Windows uses a fixed identifier, which varies between Windows versions, and a sequence number that is only reset at boot time. *The data received by the Echo Request must be entirely included in the Echo Reply. ===Echo reply=== The ''echo reply'' is an ICMP message generated in response to an echo request, and is mandatory for all hosts and routers. {| class="wikitable" ! 00 || 01 || 02 || 03 || 04 || 05 || 06 || 07 ! 08 || 09 || 10 || 11 || 12 || 13 || 14 || 15 ! 16 || 17 || 18 || 19 || 20 || 21 || 22 || 23 ! 24 || 25 || 26 || 27 || 28 || 29 || 30 || 31 |- |colspan="8" align="center"| Type = 0 |colspan="8" align="center"| Code = 0 |colspan="16" align="center"| Header Checksum |- |colspan="16" align="center"| Identifier |colspan="16" align="center"| Sequence Number |- |colspan="32" align="center"| Data ::: |} *''Type'' and ''code'' must be set to 0. *The ''identifier'' and ''sequence number'' can be used by the client to determine which echo requests are associated with the echo replies. *The data received in the echo request must be entirely included in the echo reply. ===Other replies=== In case of error, destination host or intermediate router will send back an ICMP error message, i.e. host unreachable or TTL exceeded in transit. In addition these messages include the first 8 bytes of original message (in this case header of ICMP echo request, including quench value), so ping utility can match it to originating query.{{Citation needed|date=September 2009}} ==Payload== The payload of the packet is generally filled with [[ASCII]] characters, as the output of the [[tcpdump]] utility shows: <pre style=font-size:80%> 16:24:47.966461 IP (tos 0x0, ttl 128, id 15103, offset 0, flags [none], proto: ICMP (1), length: 60) 192.168.146.22 > 192.168.144.5: ICMP echo request, id 1, seq 38, length 40 0x0000: 4500 003c 3aff 0000 8001 5c55 c0a8 9216 E..<:.....\U.... 0x0010: c0a8 9005 0800 4d35 0001 0026 6162 6364 ......M5...&abcd 0x0020: 6566 6768 696a 6b6c 6d6e 6f70 7172 7374 efghijklmnopqrst 0x0030: 7576 7761 6263 6465 6667 6869 uvwabcdefghi </pre> The payload includes a timestamp of when the message was sent, as well a sequence number. This allows ping to compute the round trip time in a [[stateless server|stateless]] manner without needing to record when packets were sent. In cases of no answer and no error message, most implementations of ping display nothing, or periodically print notifications about timing out.{{Citation needed|date=September 2009}} ==Other types of pinging== The term ''ping'' is commonly used to describe the transmission of an effectively content-less message that is used for a variety of purposes. For example, a ping may be sent using the [[User Datagram Protocol]] (UDP) to a device located behind a [[network address translator]] (NAT) to keep the port binding on the NAT translator from timing out and removing the forward mapping. Other examples are short or empty [[Instant messaging|instant message]]s, emails, voice mails, or missed-call notification 