context, the notion of an ''immutable root-of-trust'' holds that the very first code to measure security properties of a system must itself be trusted to ensure that a rootkit or bootkit does not compromise the system at its most fundamental level.<ref>{{cite web|url=http://www.trustedcomputinggroup.org/files/resource_files/87B92DAF-1D09-3519-AD80984BBE62D62D/TCG_PCSpecificSpecification_v1_1.pdf|date=2003-08-18|accessdate=2010-11-22|publisher=[[Trusted Computing Group]]|title=TCG PC Specific Implementation Specification, Version 1.1|format=PDF}}</ref> ===Memory dumps=== Forcing a complete dump of [[virtual memory]] will capture an active rootkit (or a [[core dump|kernel dump]] in the case of a kernel-mode rootkit), allowing offline analysis to be performed with a [[debugger]] against the resulting dump file, without the rootkit being able to take any measures to cloak itself. This technique is highly specialized, and may require access to non-public [[source code]] or [[Debug symbol|debugging symbols]]. Memory dumps initiated by the operating system cannot be used to detect a hypervisor-based rootkit, which is able to intercept and subvert the lowest-level attempts to read memory<ref name="Harris"/>—a hardware device, such as one that implements a [[non-maskable interrupt]], is required to dump memory in this scenario.<ref>{{cite web|url=http://support.microsoft.com/kb/927069|publisher=[[Microsoft]]|title=How to generate a complete crash dump file or a kernel crash dump file by using an NMI on a Windows-based system|accessdate=2010-11-13}}</ref><ref>{{cite journal|title=Pioneer: Verifying Code Integrity and Enforcing Untampered Code Execution on Legacy Systems|author=Seshadri, Arvind ''et al''|url=http://sparrow.ece.cmu.edu/~adrian/projects/pioneer.pdf|publisher=[[Carnegie Mellon University]]|year=2005|accessdate=2010-11-22}}</ref> ==Removal== Manual removal of a rootkit is often too difficult for a typical computer user,<ref name="McAfee2">{{cite web|url=http://www.mcafee.com/us/local_content/white_papers/wp_rootkits_0407.pdf|title=Rootkits Part 2: A Technical Primer|publisher=[[McAfee]]|date=2007-04-03|accessdate=2010-08-17|format=PDF}}{{broken link|date=December 2010}}</ref> but a number of security-software vendors offer tools to automatically detect and remove rootkits, typically as part of an [[antivirus software|antivirus suite]]. {{As of|2005}}, Microsoft's monthly Malicious Software Removal Tool is able to detect and remove some classes of rootkits.<ref>{{cite web|url=http://searchenterprisedesktop.techtarget.com/news/column/0,294698,sid192_gci1112754,00.html|title=Rootkit battle: Rootkit Revealer vs. Hacker Defender|first=Kurt |last=Dillard|date=2005-08-03}}</ref><ref>{{cite web|url=http://support.microsoft.com/?kbid=890830|title=The Microsoft Windows Malicious Software Removal Tool helps remove specific, prevalent malicious software from computers that are running Windows 7, Windows Vista, Windows Server 2003, Windows Server 2008, or Windows XP |publisher=[[Microsoft]]|date=2010-09-14}}</ref> Some antivirus scanners can bypass [[file system]] APIs, which are vulnerable to manipulation by a rootkit. Instead, they access raw filesystem structures directly, and use this information to validate the results from the system APIs to identify any differences that may be caused by a rootkit.<ref group="Notes">In theory, a sufficiently sophisticated kernel-level rootkit could subvert read operations against raw filesystem data structures as well, so that they match the results returned by APIs.</ref><ref>{{cite journal |url=http://www.infoworld.com/d/security-central/rootkits-next-big-enterprise-threat-781 |title=Rootkits: The next big enterprise threat? | last = Hultquist | first = Steve | date = 2007-04-30 | accessdate = 2010-11-21 | journal = InfoWorld | publisher = IDG }}</ref><ref>{{cite web|url=http://reviews.cnet.com/4520-3513_7-6686763-1.html |title=Security Watch: Rootkits for fun and profit|publisher=CNET Reviews |date=2007-01-19 |accessdate=2009-04-07}}</ref><ref>{{cite web|url=http://www.pcworld.com/businesscenter/article/137821/six_ways_to_fight_back_against_botnets.html |title=Six ways to fight back against botnets |work=''[[PC World (magazine)|PCWorld]]'' |date=2007-09-29 | last = Bort | first = Julie | publisher = PCWorld Communications | loation = San Francisco |accessdate=2009-04-07}}</ref><ref>{{ cite web|first = Mimi | last = Hoang|url=http://www.symantec.com/connect/blogs/handling-todays-tough-security-threats-rootkits|title=Handling Today's Tough Security Threats: Rootkits |publisher=[[Symantec]] | work = Symantec Connect |date=2006-11-02 |accessdate=2010-11-21}}</ref> There are experts{{who|date=December 2010}} who believe that the only reliable way to remove them is to re-install the operating system from trusted media.<ref name="ms-obscure-hacker">{{cite web|url=http://technet.microsoft.com/en-us/library/cc512642.aspx|title=Rootkits: The Obscure Hacker Attack |date=2005-10-06|publisher=Microsoft|first=Mike |last=Danseglio |first2=Tony |last2=Bailey}}</ref><ref>{{cite news|url=http://www.networkworld.com/news/2006/082806-rootkits.html|title=Experts Divided Over Rootkit Detection and Removal|first=Ellen |last=Messmer|work=NetworkWorld.com|date=2006-08-26|accessdate=2010-08-15|publisher=IDG|location=Framingham, Mass.}}</ref> This is because antivirus and malware removal tools running on an untrusted system may be ineffective against well-written kernel-mode rootkits. Booting an alternate operating system from trusted media can allow an infected system volume to be mounted and potentially safely cleaned and critical data to be copied off—or, alternatively, a forensic examination performed.<ref name="anson-forensics">{{cite book|url=http://books.google.com/books?id=BhdP2PZy6SoC|title=Mastering Windows Network Forensics and Investigation|first=Steve|last= Anson|first2= Steve |last2=Bunting|isbn=0470097620|publisher=John Wiley and Sons|year=2007|pages=73–74}}</ref> Lightweight operating systems such as [[Windows PE]], [[Recovery Console|Windows Recovery Console]], [[Windows Recovery Environment]], [[BartPE]], or [[Live CD|Live Distros]] can be used for this purpose, allowing the system to be cleaned. Even if the type and nature of a rootkit is known, manual repair may be impractical, while re-installing the operating system and applications is safer, simpler and quicker.<ref name="ms-obscure-hacker"/> ==Public availability== Like much malware used by attackers, many rootkit implementations are shared and are easily available on the Internet. It is not uncommon to see a compromised system in which a sophisticated, publicly-available rootkit hides the presence of unsophisticated [[computer worm|worms]] or attack tools that appear to have been written by inexperienced programmers.<ref name="anson-forensics"/> Most of the rootkits available on the Internet are constructed as an exploit or academic "[[proof of concept]]" to demonstrate varying methods of hiding things within a computer system and taking unauthorized control of it.<ref>{{cite book|url=http://books.google.com/books?id=MTcep7V6heUC|page=175|title=Rootkits for Dummies|publisher=John Wiley and Sons Ltd|year=2007|isbn=0471917109|first=Larry |last=Stevenson|first2= Nancy |last2=Altholz}}</ref>{{dubious|GA Review|date=December 2010|reason=Not in source}} Since these are often not fully optimized for stealth, they sometimes leave unintended evidence of their presence. Even so, when such rootkits are used in an attack, they are often effective. ==Defences== System [[hardening (computing)|hardening]] represents one of the first layers of defence against a rootkit, to prevent it from being able to install.<ref>{{cite book|url=http://books.google.com/books?id=JHgX8_pVPpEC|page=335|title=Malware: Fighting Malicious Code|first=Ed|last=Skoudis|first2=Lenny|last2=Zeltser|publisher=Prentice Hall PTR|year=2004|isbn=0131014056}}</ref> Applying security patches, implementing the [[principle of least privilege]], reducing the [[attack surface]] and installing antivirus software are some standard security best practices that are effective against all classes of malware. Once these measures are in place, routine monitoring is required.<ref>{{cite web|url=http://www.sans.org/reading_room/whitepapers/linux/linux-rootkits-beginners-prevention-removal_901|title=Linux RootKits For Beginners - From Prevention to Removal|publisher=[[SANS Institute]]|date=2003-01-23|accessdate=2010-11-22|format=PDF|first=Jeromey|last=Hannel}}</ref> ==See also== *[[Man-in-the-middle attack]] *[[Hacker con]] *[[Host-based intrusion detection system]] *[[SANS Institute|The SANS Institute]] *[[The Rootkit Arsenal: Escape and Evasion in the Dark Corners of the System]] ==Notes== {{Reflist|group="Notes"}} == References == {{Reflist|2}} ==Further reading== * {{cite book|first= Bill|last= Blunden|title=The Rootkit Arsenal: Escape and Evasion in the Dark Corners of the System|publisher=Wordware|year=2009|isbn=978-1598220612}} * {{cite journal|last=Grampp|first=F. T. |last2 = Morris |first2= Robert H., Sr. |title=The UNIX System: UNIX Operating System Security|publisher=AT&T|volume= 62| issue = 8|year=1984|journal=AT&T Bell Laboratories Technical Journal|month=October|pages=1649–1672}} * {{cite book|title=Designing BSD Rootkits|first=Joseph |last=Kong|publisher=No Starch Press|year=2007|isbn=1593271425}} * {{cite book|first=Ric|last= Veiler|title=Professional Rootkits|publisher=Wrox|year=2007|isbn=978-0-470-10154-4}} == External links == * [http://www.rootkitanalytics.com Rootkit Analysis: Research and Analysis of Rootkits] * [http://www.informit.com/articles/article.aspx?p=23463 Even Nastier: Traditional RootKits] * [http://podcasts.sophos.com/en/sophos-podcasts-004.mp3 Sophos Podcast about rootkit removal] * [http://research.microsoft.com/Rootkit/ Rootkit research in Microsoft] * [http://www.anti-malware-test.com/?q=taxonomy/term/7 Testing of antivirus/anti-rootkit software for the detection and removal of rootkits], Anti-Malware Test Lab, 