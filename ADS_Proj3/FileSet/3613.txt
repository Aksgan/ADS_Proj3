single vertex). :The '''maximal pseudoforests of''' ''G'' are the pseudoforest subgraphs of ''G'' that are not contained within any larger pseudoforest of ''G''. A maximal pseudoforest of ''G'' is always a spanning pseudoforest, but not conversely. If ''G'' has no connected components that are trees, then its maximal pseudoforests are 1-forests, but if ''G'' does have a tree component, its maximal pseudoforests are not 1-forests. Stated precisely, in any graph ''G'' its maximal pseudoforests consist of every tree component of ''G'', together with one or more disjoint 1-trees covering the remaining vertices of ''G''. ==Directed pseudoforests== Versions of these definitions are also used for [[directed graph]]s. Like an undirected graph, a directed graph consists of vertices and edges, but each edge is directed from one of its endpoints to the other endpoint. A '''directed pseudoforest''' is a directed graph in which each vertex has at most one outgoing edge; that is, it has [[outdegree]] at most one. A '''directed 1-forest''' &ndash; most commonly called a '''functional graph''' (see [[#Graphs of functions|below]]), sometimes '''maximal directed pseudoforest''' &ndash; is a directed graph in which each vertex has outdegree exactly one.<ref>{{harvtxt|Kruskal|Rudolph|Snir|1990}} instead use the opposite definition, in which each vertex has indegree one; the resulting graphs, which they call ''unicycular'', are the [[transpose graph|transposes]] of the graphs considered here.</ref> If ''D'' is a directed pseudoforest, the undirected graph formed by removing the direction from each edge of ''D'' is an undirected pseudoforest. ==Number of edges== Every pseudoforest on a set of ''n'' vertices has at most ''n'' edges, and every maximal pseudoforest on a set of ''n'' vertices has exactly ''n'' edges. Conversely, if a graph ''G'' has the property that, for every subset ''S'' of its vertices, the number of edges in the [[induced subgraph]] of ''S'' is at most the number of vertices in ''S'', then ''G'' is a pseudoforest. 1-trees can be defined as connected graphs with equally many vertices and edges.<ref name="gt"/> Moving from individual graphs to graph families, if a family of graphs has the property that every subgraph of a graph in the family is also in the family, and every graph in the family has at most as many edges as vertices, then the family contains only pseudoforests. For instance, every subgraph of a [[thrackle]] (a graph [[graph drawing|drawn]] so that every pair of edges has one point of intersection) is also a thrackle, so [[John H. Conway|Conway's]] [[conjecture]] that every thrackle has at most as many edges as vertices can be restated as saying that every thrackle is a pseudoforest. A more precise characterization is that, if the conjecture is true, then the thrackles are exactly the pseudoforests with no four-vertex cycle and at most one odd cycle.<ref>{{harvtxt|Woodall|1969}}; {{harvtxt|Lovász|Pach|Szegedy|1997}}.</ref> Streinu and Theran<ref name="st">{{harvtxt|Streinu|Theran|2007}}.</ref> generalize the [[sparse graph|sparsity]] conditions defining pseudoforests: they define a graph as being (''k'',''l'')-sparse if every nonempty subgraph with ''n'' vertices has at most ''kn'' &minus; ''l'' edges, and (''k'',''l'')-tight if it is (''k'',''l'')-sparse and has exactly ''kn'' &minus; ''l'' edges. Thus, the pseudoforests are the (1,0)-sparse graphs, and the maximal pseudoforests are the (1,0)-tight graphs. Several other important families of graphs may be defined from other values of ''k'' and ''l'', and when ''l'' ≤ ''k'' the (''k'',''l'')-sparse graphs may be characterized as the graphs formed as the edge-disjoint union of ''l'' forests and ''k'' &minus; ''l'' pseudoforests.<ref>{{harvtxt|Whiteley|1988}}.</ref> Almost every sufficiently sparse [[random graph]] is pseudoforest.<ref name="rg">{{harvtxt|Bollobás|1985}}. See especially Corollary 24, p.120, for a bound on the number of vertices belonging to unicyclic components in a random graph, and Corollary 19, p.113, for a bound on the number of distinct labeled unicyclic graphs.</ref> That is, if ''c'' is a constant with 0 < ''c'' < 1/2, and P<sub>''c''</sub>(''n'') is the probability that choosing uniformly at random among the ''n''-vertex graphs with ''cn'' edges results in a pseudoforest, then P<sub>''c''</sub>(''n'') tends to one in the limit for large ''n''. However, for ''c'' > 1/2, almost every random graph with ''cn'' edges has a large component that is not unicyclic. ==Enumeration== A graph is ''simple'' if it has no self-loops and no multiple edges with the same endpoints. The number of simple 1-trees with ''n'' labelled vertices is<ref>{{harvtxt|Riddell|1951}}; see Sequence A057500 in {{harvtxt|Sloane|online}}.</ref> :<math>n \sum_{k=1}^n \frac{(-1)^{k-1}}{k} \sum_{n_1+\cdots+n_k=n} \frac{n!}{n_1! \cdots n_k!} \binom{\binom{n_1}{2}+\cdots +\binom{n_k}{2}}{n}.</math> The values for ''n'' up to 18 can be found in Sequence A057500 in {{harvtxt|Sloane|online}}. The number of maximal directed pseudoforests on ''n'' vertices, allowing self-loops, is ''n<sup>n</sup>'', because for each vertex there are ''n'' possible endpoints for the outgoing edge. [[André Joyal]] used this fact to provide a [[bijective proof]] of [[Cayley's formula]], that the number of undirected trees on ''n'' nodes is ''n''<sup>''n'' &minus; 2</sup>, by finding a bijection between maximal directed pseudoforests and undirected trees with two distinguished nodes.<ref>{{harvtxt|Aigner|Ziegler|1998}}.</ref> If self-loops are not allowed, the number of maximal directed pseudoforests is instead (''n'' &minus; 1)<sup>''n''</sup>. ==Graphs of functions== [[Image:Functional graph.svg|thumb|300px|A function from the set {0,1,2,3,4,5,6,7,8} to itself, and the corresponding functional graph]] Directed pseudoforests and [[Function (mathematics)|function]]s are in some sense mathematically equivalent. Any function &fnof; from a set ''X'' to itself (that is, an [[endomorphism]] of ''X'') can be interpreted as defining a directed pseudoforest which has an edge from ''x'' to ''y'' whenever &fnof;(''x'') = ''y''. The resulting directed pseudoforest is maximal, and may include [[Loop (graph theory)|self-loops]] whenever some value ''x'' has &fnof;(''x'') = ''x''. Alternatively, omitting the self-loops produces a non-maximal pseudoforest. In the other direction, any maximal directed pseudoforest determines a function &fnof; such that &fnof;(''x'') is the target of the edge that goes out from ''x'', and any non-maximal directed pseudoforest can be made maximal by adding self-loops and then converted into a function in the same way. For this reason, maximal directed pseudoforests are sometimes called '''functional graphs'''.<ref name="gt"/> Viewing a function as a functional graph provides a convenient language for describing properties that are not as easily described from the function-theoretic point of view; this technique is especially applicable to problems involving [[iterated function]]s, which correspond to [[path (graph theory)|paths]] 