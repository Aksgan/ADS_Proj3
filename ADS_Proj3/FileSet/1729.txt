the figure. The distance between these two points is the diameter of the circle of intersection. [[Image:lat 2spheres 2.svg|thumb|center|Two sphere surfaces intersecting in a circle]] This can be seen more clearly by considering a side view of the intersecting spheres. This view would match the figure because of the symmetry of the spheres. A view from any horizontal direction would look exactly the same. Therefore the diameter as seen from all directions is the same and thus the surfaces actually do intersect in a circle. The article [[trilateration]] [[algebra]]ically confirms this geometric argument that the two sphere surfaces intersect in a circle. Having found that two sphere surfaces intersect in a circle, we now consider how the intersection of the first two sphere surfaces, the circle, intersect with the third sphere. A circle and sphere surface intersect at zero, one or two points. For the GPS problem we are concerned with the case of two points of intersection. Another figure, Surface of Sphere Intersecting a Circle (not a solid disk) at Two Points, is shown below to aid in visualizing this intersection. Trilateration [[algebra]]ically confirms this geometric observation. The ambiguity of two points of intersection of three sphere surfaces can be resolved by noting the point that is closest to the fourth sphere surface. [[Image:circle sphere 2-colour.svg|thumb|center|Surface of a sphere intersecting a circle (i.e., the edge of a disk) at two points]] Having provided a discussion of how sphere surfaces intersect, we now formulate the equations for the case when errors are present. Let <math>\ \ b</math> denote the clock error or bias, the amount that the receiver's clock is off. The receiver has four unknowns, the three components of GPS receiver position and the clock bias <math>\ \left [x, y, z, b\right ]</math>. The equation of the sphere surfaces are given by: <math>(x-x_i)^2 + (y-y_i)^2 + (z-z_i)^2 = \bigl([tr_i + b - t_i]c\bigr)^2,</math> :<math>\;i=1,2,3,4</math> Another useful form of these equations is in terms of ''pseudoranges'', which are the approximate ranges based on the receiver clock's uncorrected time so that <math> p_i = \left (tr_i - t_i \right )c</math>. Then the equations becomes: :<math>p_i = \sqrt{(x-x_i)^2 + (y-y_i)^2 + (z-z_i)^2}- bc, \;i=1,2,3,4.</math> === Methods of solution of navigation equations === * Bancroft's method is perhaps the most important method of solving the navigation equations because it involves an algebraic as opposed to numerical method.<ref name="Bancroft">{{cite web|url=http://www.macalester.edu/~halverson/math36/GPS.pdf |title=Global Positioning Systems |format=PDF |date= |accessdate=2010-10-15}}</ref> The method requires at least four satellites but more can be used. Two numerical methods of computing GPS receiver position and clock bias are (1) by using [[trilateration]] and one dimensional numerical root finding and (2) [[multidimensional]] [[Newton-Raphson]] calculations. * The receiver can use [[trilateration]] <ref name="HGPSW1"> [http://www.kowoma.de/en/gps/positioning.htm Position Determination with GPS.] Konowa.de (2005).</ref><ref name="Howstuff01"> [http://electronics.howstuffworks.com/gadgets/travel/gps2.htm How GPS Receivers Work] at How Stuff Works</ref> and one dimensional numerical root finding.<ref name="NR"> Press, Flannery, Tekolsky, and Vetterling 1986, ''Numerical Recipes, The Art of Scientific Computing'' (Cambridge University Press).</ref> Trilateration is used to determine the intersection of the surfaces of three spheres. In the usual case of two intersections, the point nearest the surface of the sphere corresponding to the fourth satellite is chosen. The Earth's surface can also sometimes be used instead, especially by civilian GPS receivers, because it is illegal in the United States to track vehicles more than {{convert|60,000|ft|m}} in altitude. Let da denote the signed magnitude of the vector from the receiver position to the fourth satellite (i.e. da = r4 - p4) as defined in the section "Clock correction". da is a function of the correction because the correction changes the satellite transmission times and thus the pseudoranges. The notation, da(correction) denotes this function. The problem is to determine the correction such that :<math>da\left(correction\right) = 0</math>. This is the familiar problem of finding the zeroes of a one dimensional non-linear function of a scalar variable. Iterative numerical methods, such as those found in the chapter on root finding in ''Numerical Recipes'' can solve this type of problem.<ref name="NR"/> One advantage of this method is that it involves one dimensional as opposed to multidimensional numerical root finding. * <span id="pos_multi_nr"></span>Alternatively, multidimensional root finding method such as [[Newton-Raphson]] method can be used.<ref name="NR"/> The approach is to linearize around an approximate solution, say <math>\ \left [x^{(k)}, y^{(k)}, z^{(k)}, b^{(k)}\right ]</math> from iteration ''k,'' then solve four linear equations derived from the quadratic equations above to obtain <math>\left [x^{(k+1)}, y^{(k+1)}, z^{(k+1)}, b^{(k+1)}\right ]</math>. The Newton-Raphson method is more rapidly convergent than other methods of numerical root finding.<ref name="NR"/> A disadvantage of this multidimensional root finding method as compared to single dimensional root findiing is that, "There are no good general methods for solving systems of more than one nonlinear equations."<ref name="NR"/> * When more than four satellites are available, the calculation can use the four best or more than four, considering number of channels, processing capability, and [[#gdop|geometric dilution of precision]] (GDOP). Using more than four is an over-determined system of equations with no unique solution, which must be solved by [[least-squares]] or a similar technique.<ref name="Bancroft"/> If all visible satellites are used, the results are as good as or better than using the four best. Errors can be estimated through the residuals. With each combination of four or more satellites, a GDOP factor can be calculated, based on the relative sky directions of the satellites used.<ref>{{cite web |url=http://www.colorado.edu/geography/gcraft/notes/gps/gps.html#Gdop |title=Geometric Dilution of Precision (GDOP) and Visibility |first=Peter H. |last=Dana |publisher=University of Colorado at Boulder |accessdate=2008-07-07}}</ref> As more satellites are picked up, pseudoranges from various 4-way combinations can be processed to add more estimates to the location and clock offset. The receiver then takes the weighted average of these positions and clock offsets. After the final location and time are calculated, the location is expressed in a specific coordinate system such as [[latitude]] and [[longitude]], using the [[WGS 84]] [[datum (geodesy)|geodetic datum]] or a country-specific system.<ref>{{cite web |url=http://www.colorado.edu/geography/gcraft/notes/gps/gps.html#PosVelTime |title=Receiver Position, Velocity, and Time |author=Peter H. Dana |publisher=University of Colorado at Boulder |accessdate=2008-07-07}}</ref> * Finally, results from other positioning systems 