Security Guide, Chapter 3], Microsoft, ''TechNet''</ref> : Computer Configuration \ Administrative Templates \ Windows Components \ Autoplay Policies The per-user policy location is: : User Configuration \ Administrative Templates \ Windows Components \ AutoPlay Policies The relevant policy is "Turn off Autoplay" and can be set for CD-ROM, DVD-ROM and removable drives or all drives. Two related policies were added in Vista and Server 2008:<ref name=vistagpo>[http://www.microsoft.com/downloads/details.aspx?familyid=18C90C80-8B0A-4906-A4F5-FF24CC2030FB&displaylang=en Group Policy Settings Reference for Windows and Windows Server], Microsoft, ''Downloads'', [[Microsoft Excel|Excel]] Spreadsheets.</ref> <dl> <dt>Default behavior for AutoRun</dt> <dd> {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="4" | <tt>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> <br> <tt>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> |- ! Entry name !! Data type !! Range !! Default |- | <tt>NoAutoRun</tt> | <center> REG_DWORD </center> | <center></center> | <center></center> |} Sets the default behavior for AutoRun commands found in autorun.inf files. Prior to Windows Vista, when media containing an autorun.inf specifying an AutoRun task was inserted, the default action was to automatically execute the program without user intervention. From Windows Vista the default behaviour is to invoke AutoPlay and represent the AutoRun task as one of the dialog options. This is also the behaviour when this policy is Not configured or Disabled. If this policy is Enabled, the behaviour can be changed to either: * Completely disable autorun.inf commands ''or'' * Automatically execute the autorun.inf command as per previous Windows versions. </dd> <dt>Don't set the always do this checkbox</dt> <dd> {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="4" | <tt>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> <br> <tt>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> |- ! Entry name !! Data type !! Range !! Default |- | <tt>DontSetAutoplayCheckbox</tt> | <center> REG_DWORD </center> | <center></center> | <center></center> |} If this policy is Enabled, the "Always do this..." checkbox in the AutoPlay dialog will not be set by default when the dialog is shown. </dd> </dl> === Windows 7, Windows Server 2008 R2 === In these versions of Windows, the ability of an autorun.inf file to set an AutoRun task, alter double-click behaviour or change context menus is restricted to drives of type DRIVE_CDROM. There are no policy settings that will override this behaviour. Policy locations and settings are as per ''Windows Vista, Windows Server 2008'' above with the addition of:<ref name=vistagpo/> <dl> <dt>Turn off Autoplay for non-volume devices</dt> <dd> {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="4" | <tt>HKLM\Software\Policies\Microsoft\Windows\Explorer</tt> <br> <tt>HKCU\Software\Policies\Microsoft\Windows\Explorer</tt> |- ! Entry name !! Data type !! Range !! Default |- | <tt>NoAutoplayfornonVolume</tt> | <center></center> | <center></center> | <center></center> |} If this policy is enabled, AutoPlay will be disabled for [[AutoPlay#Devices that are not drives|non-volume]] devices. </dd> </dl> == Altering AutoRun behaviour == === Pressing the Shift key === If the {{keypress|Shift}} key is held down at a certain point in the execution sequence Windows Vista invokes the AutoPlay dialog regardless of any AutoPlay settings to the contrary.<ref name=vista_ap_faq/> Previous versions of Windows do not execute the AutoRun task.<ref name=enadis/> Given that Shift must be held down until Windows checks for it, it may be a considerable amount of time before it becomes effective. The time taken primarily depends on the time to recognise the new hardware and the time taken for CD-ROMs to spin up. It is unsafe to rely on this method. === Auto Insert Notification === Certain [[#Initiation and notification|Media Change Notification]] events may be suppressed by altering certain Registry entries. "Media Change Notification" is the generic term; for CD-ROM drives, the specific term is "Auto Insert Notification". {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="4" | <tt>HKLM\SYSTEM\CurrentControlSet\Services\Cdrom</tt> |- ! Entry name !! Data type !! Range !! Default |- | <tt>AutoRun</tt> | <center> REG_DWORD </center> | <center> 0 or 1 </center> | <center> 1 </center> |} For CD-ROM drives, changing the value of this Registry entry to 0, will disable Auto Insert Notification for CD-ROM drives only.<ref>[http://technet.microsoft.com/en-gb/library/cc976182.aspx Windows 2000 Registry: AutoRun], Microsoft, ''TechNet''</ref> A Windows restart will be necessary. {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- ! Data value !! Meaning |- | <center>0</center> || Does not send an MCN message |- | <center>1</center> || Sends an MCN message |} Under Windows 95/98/ME, this setting can be changed under Device Manager, accessible from the System icon in Control Panel. [[Image:Win98 devmgr ain.png|thumb|Auto insert notification under Windows 98]] Although the Registry entry is named "AutoRun", it only suppresses the MCN message. The MCN message does trigger AutoRun initiation but it also instructs the Explorer shell to update its views and contents. Thus, as a side effect only, this disables AutoRun for CD-ROM drives. However, Explorer will now not update its view when a new CD is inserted; it will show the contents of the previous CD until {{keypress|F5}} is pressed or View/Refresh is selected from the Explorer menu. This could result in severe confusion for users. For this reason the Media Change Notification message should not be disabled unless there is absolutely no alternative; AutoRun can be disabled for individual drives using Group Policy or the Registry. {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="2" | <tt>HKLM\SYSTEM\CurrentControlSet\Services\Cdrom</tt> |- ! Entry name !! Data type |- | <tt>AutoRunAlwaysDisable</tt> | REG_MULTI_SZ |} This entry is used to suppress the MCN message for specifically listed type of CD-ROM drive,<ref>[http://technet.microsoft.com/en-gb/library/cc960238.aspx Windows 2000 Registry: AutoRunAlwaysDisable], Microsoft, ''TechNet''</ref> primarily CD-ROM changers. The data is a set of device identifiers, which matches those identifiers reported to the system by the devices themselves. The default value for this entry consists of products identified by Microsoft testing as being unable to support AutoRun. This entry should not be altered from its default. === Editing Group Policy === AutoRun may be suppressed on particular drives and drive types by using the methods described in the [[#Group Policy|Group Policy]] section. However, the Group Policy Editor is not available on Home versions of Windows XP<ref>[http://technet.microsoft.com/en-us/library/bb457127.aspx Windows XP Pro Resource Kit, Differences with Windows XP Home Edition], Microsoft, ''TechNet''</ref> and does not provide any fine-grained drive selection facilities. However, Group Policy would be the accepted method of disabling AutoRun on an entire Windows domain. === Registry files === A Registry setting file can be created 