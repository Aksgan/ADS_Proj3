probability space, } \mu(X)=1.) </math> In general the time average and space average may be different. But if the transformation is ergodic, and the measure is invariant, then the time average is equal to the space average [[almost everywhere]]. This is the celebrated ergodic theorem, in an abstract form due to [[George David Birkhoff]]. (Actually, Birkhoff's paper considers not the abstract general case but only the case of dynamical systems arising from differential equations on a smooth manifold.) The [[equidistribution theorem]] is a special case of the ergodic theorem, dealing specifically with the distribution of probabilities on the unit interval. More precisely, the '''pointwise''' or '''strong ergodic theorem''' states that the limit in the definition of the time average of ''f'' exists for almost every ''x'' and that the (almost everywhere defined) limit function <math>\hat f</math> is integrable: :<math>\hat f \in L^1(\mu). \, </math> Furthermore, <math>\hat f</math> is ''T''-invariant, that is to say :<math>\hat f \circ T= \hat f \, </math> holds almost everywhere, and if <math>\mu(X)</math> is finite, then the normalization is the same: :<math>\int \hat f\, d\mu = \int f\, d\mu.</math> In particular, if ''T'' is ergodic, then <math>\hat f</math> must be a constant (almost everywhere), and so one has that :<math>\bar f = \hat f \, </math> almost everywhere. Joining the first to the last claim and assuming that <math>\mu(X)</math> is finite and nonzero, one has that :<math>\lim_{n\rightarrow\infty}\; \frac{1}{n} \sum_{k=0}^{n-1} f\left(T^k x\right) = \frac 1{\mu(X)}\int f\,d\mu </math> for [[almost all]] ''x'', i.e., for all ''x'' except for a set of [[Lebesgue measure|measure]] zero. For an ergodic transformation, the time average equals the space average almost surely. As an example, assume that the measure space <math>(X,\Sigma,\mu)</math> models the particles of a gas as above, and let ''f''(''x'') denotes the [[velocity]] of the particle at position ''x''. Then the pointwise ergodic theorems says that the average velocity of all particles at some given time is equal to the average velocity of one particle over time. ==Probabilistic formulation: Birkhoff–Khinchin theorem==<!-- This section, with the title "Probabilistic formulation: Birkhoff–Khinchin theorem" (with an en-dash, not a hyphen), is linked from six redirect pages. --> '''Birkhoff–Khinchin theorem'''. Let <math>f</math> be measurable, <math>E(|f|)<+\infty</math>, and <math>T</math> be a measure-preserving map. Then :<math>\lim_{n\rightarrow\infty}\; \frac{1}{n} \sum_{k=0}^{n-1} f\left(T^k x\right)=E(f|\mathcal{C}),</math> where <math>E(f|\mathcal{C})</math> is the [[conditional expectation]] given the <math>\sigma</math>-algebra <math>\mathcal{C}</math> of invariant sets of <math>T</math>. Corollary ('''Pointwise ergodic theorem''') In particular, if <math>T</math> is also ergodic, then <math>\mathcal{C}</math> is the trivial <math>\sigma</math>-algebra, and thus :<math>\lim_{n\rightarrow\infty}\; \frac{1}{n} \sum_{k=0}^{n-1} f\left(T^k x\right)=E(f)\text{ a.s.}</math> ==Mean ergodic theorem== Another form of the ergodic theorem, '''von Neumann's mean ergodic theorem''', holds in Hilbert spaces.<ref>I: Functional Analysis : Volume 1 by Michael Reed, Barry Simon,Academic Press; REV edition (1980)</ref> Let <math>U</math> be a [[unitary operator]] on a [[Hilbert space]] <math>H</math>; more generally, an isometric linear operator (that is, a not necessarily surjective linear operator satisfying <math>\|Ux\|=\|x\|</math> for all <math>x \in H</math>, or equivalently, satisfying <math>U^*U=I,</math> but not necessarily <math>UU^*=I</math>). Let <math>P</math> be the [[orthogonal projection]] onto <math>\{\psi \in H| U\psi=\psi\} = \operatorname{Ker}(I-U)</math>. Then, for any <math>x \in H</math>, we have: :<math> \lim_{N \to \infty} {1 \over N} \sum_{n=0}^{N-1} U^{n} x = P x,</math> where the limit is with respect to the norm on ''H''. In other words, the sequence of averages :<math>\frac{1}{N} \sum_{n=0}^{N-1}U^n</math> converges to ''P'' in the [[strong operator topology]]. This theorem specializes to the case in which the Hilbert space ''H'' consists of ''L''<sup>2</sup> functions on a measure space and ''U'' is an operator of the form :<math>Uf(x) = f(Tx) \, </math> where ''T'' is a measure-preserving endomorphism of ''X'', thought of in applications as representing a time-step of a discrete dynamical system.<ref>{{harv|Walters|1982}}</ref> The ergodic theorem then asserts that the average behavior of a function ''f'' over sufficiently large time-scales is approximated by the orthogonal component of ''f'' which is time-invariant. In another form of the mean ergodic theorem, let ''U''<sub>''t''</sub> be a strongly continuous [[one-parameter group]] of unitary operators on ''H''. Then the operator :<math>\frac{1}{T}\int_0^T U_t\,dt</math> converges in the strong operator topology as ''T'' → ∞. In fact, this result also extends to the case of strongly continuous [[one-parameter semigroup]] of contractive operators on a reflexive space. Remark: Some intuition for the mean ergodic theorem can be developed by considering the case where complex numbers of unit length are regarded as unitary transformations on the complex plane (by left multiplication). If we pick a single complex number of unit length (which we think of as <math>U</math>), it is intuitive that its powers will fill up the circle. Since the circle is symmetric around 0, it makes sense that the averages of the powers of <math>U</math> will converge to 0. Also, 0 is the only fixed point of <math>U</math>, and so the projection onto the space of fixed points must be the zero operator (which agrees with the limit just described). ==Convergence of the ergodic means in the <math>L^p</math> norms== Let <math>(X,\Sigma,\mu)</math> be as above a probability space with a measure preserving transformation ''T'', and let <math>1\leq p\leq \infty</math>. The conditional expectation with respect to the sub-σ-algebra <math>\Sigma_T</math> of the ''T''-invariant sets is a linear projector <math>E_T</math> of norm 1 of the Banach space <math>L^p(X,\Sigma,\mu)</math> onto its closed subspace <math>L^p(X,\Sigma_T,\mu).</math> The latter may also be characterized as the space of all ''T''-invariant <math>L^p</math>-functions on ''X''. The ergodic means, as linear operators on <math>L^p(X,\Sigma,\mu)</math> also have unit operator norm; and, as a simple consequence of the Birkhoff–Khinchin theorem, converge to the projector <math>E_T</math> in the strong operator topology of <math>L^p</math> if <math>1\leq p<\infty,</math> and in the weak operator topology if <math>p=\infty</math>. More is true if <math>1<p\leq \infty:</math> then the Wiener–Yoshida–Kakutani ergodic dominated convergence theorem states that the ergodic means of <math>f\in L^p</math> are dominated in <math>L^p</math>; however, if <math>f\in L^1</math>, the ergodic means may fail to be equidominated in <math>L^1</math>. Finally, if ''f'' is assumed to be in the Zygmund class, that is <math>|f|\log^+|f|</math> is integrable, then the ergodic means are even dominated in <math>L^1</math>. ==Sojourn time== Let <math>(X,\Sigma,\mu)</math> be a measure space such that <math>\mu(X)</math> is finite and nonzero. The time spent in a 