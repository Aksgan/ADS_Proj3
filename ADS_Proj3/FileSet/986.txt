countries—most famously, [[Nazi Germany]].]][[Image:Enigma rotor set.png|thumbnail|right|A series of three rotors from an Enigma machine]] The Enigma was potentially an excellent system. It was designed to defeat [[cryptanalysis|cryptanalytic]] techniques by continually changing the [[substitution alphabet]] through the use of a scrambler comprising three—or in some cases, four—[[Enigma rotor details|rotor]]s. Like other [[rotor cipher machine|rotor cipher-machine]]s, Enigma generated a [[polyalphabetic substitution]] cipher, with a period before repetition that was much longer than any message, or set of messages, sent with the same key. ===Structure=== The mechanism of the Enigma consisted of a [[Keyboard (computing)|keyboard]] connected to a [[Battery (electricity)|battery]] and a [[Enigma machine#Entry wheel|current entry plate]] or wheel (German: ''Eintrittswalze''), at the right hand end of the scrambler (usually via a [[plugboard]] in the military versions).<ref>Alexander (c. 1945) "Background" Para. 2</ref> This contained a set of 26 contacts that made electrical connection with the set of 26 spring-loaded pins on the right hand rotor. The internal wiring of the core of each rotor provided an electrical pathway from the pins on one side to different connection points on the other. The left hand side of each rotor made electrical connection with the rotor to its left. The leftmost rotor then made contact with the [[Enigma machine#Reflector|reflector]] (German: ''Umkehrwalze''). The reflector provided a set of thirteen paired connections to return the current back through the scrambler rotors, and eventually to the lampboard where a lamp under a letter was illuminated.<ref>{{ Citation | last = Ellsbury | first = Graham | publication-date = 1998 | title = Description of the Enigma Machine | series = The Enigma Machine: Its Construction, Operation and Complexity | url = http://www.ellsbury.com/enigma2.htm | accessdate = 21 January 2009 }}</ref> Whenever a key on the keyboard was pressed, the [[Enigma machine#Stepping motion|stepping motion]] was actuated, moving the rightmost rotor on one position. Because it advanced with each key pressed it is sometimes called the ''fast rotor''. When a notch on that rotor engaged with a [[Enigma machine#Stepping motion|pawl]] on the middle rotor, that too moved; and similarly with the leftmost ('slow') rotor. There are a huge number of ways that the connections within each scrambler rotor—and between the entry plate and the keyboard or plugboard or lampboard—could be arranged. For the reflector plate there are fewer, but still a large number of options to its possible wirings.<ref>Churchhouse (2002) pp.202-204</ref> Each scrambler rotor could be set to any one of its 26 starting positions (any letter of the alphabet). For the Enigma machines with only three rotors, their sequence in the scrambler—which was known as the ''wheel order (WO)'' to [[Allies of World War II|Allied]] cryptanalysts—could be selected from the six that are possible. {| class="wikitable" | border=1 | style="margin: 1em auto 1em auto" |+ Possible rotor sequences—also known as ''Wheel Order (WO)'' |- ! width="70pt"| Left ! width="70pt"| Middle ! width="70pt"| Right |- | align="center" | I ||align="center" | II ||align="center" | III |- | align="center" | I || align="center" | III || align="center" | II |- | align="center" | II || align="center" | I || align="center" | III |- | align="center" | II || align="center" | III || align="center" | I |- | align="center" | III || align="center" | I || align="center" | II |- | align="center" | III || align="center" | II || align="center" | I |} [[Image:Enigma-plugboard.jpg|right|thumbnail|The plugboard (''Steckerbrett'') was positioned at the front of the machine, below the keys. In the above photograph, two pairs of letters have been swapped (A-J and S-O).]] Later Enigma models included an ''alphabet ring'' like a tyre around the core of each rotor. This could be set in any one of 26 positions in relation to the rotor's core. The ring contained one or more notches that engaged with a pawl that advanced the next rotor to the left.<ref>{{ Citation | last = Sale | first = Tony | author-link = Anthony Sale | title = The components of the Enigma machine | series = Enigma rotors (or wheels) | url = http://www.codesandciphers.org.uk/enigma/enigma2.htm | accessdate = 1 January 2010 }}</ref> Later still, the three rotors for the scrambler were selected from a set of five or, in the case of the German Navy, eight rotors. The alphabet rings of rotors VI, VII and VIII contained two notches which, despite shortening the period of the key, made decryption more difficult. Most military Enigmas also featured a [[plugboard]] (German: ''Steckerbrett''). This altered the electrical pathway between the keyboard and the entry wheel of the scrambler and, in the opposite direction, between the scrambler and the lampboard. It did this by exchanging letters reciprocally, so that if ''A'' was plugged to ''G'' then pressing key ''A'' would lead to current entering the scrambler at the ''G'' position, and if ''G'' was pressed the current would enter at ''A''. The same connections applied for the current on the way out to the lamp panel. For an enemy to decipher German military Enigma messages required that the following were known. :'''Logical structure of the machine''' (unchanging) ::The wiring between the keyboard (and lampboard) and the entry plate. ::The wiring of each rotor. ::The number and position(s) of turnover notches on the rings of the rotors. ::The wiring of the reflectors. :'''Internal settings''' (usually changed less frequently than external settings) ::The selection of rotors in use and their positions on the spindle (''Walzenlage'' or "wheel order"). ::The positions of the alphabet ring's turnover notch in relation to the core of each rotor in use (''Ringstellung'' or "ring settings"). :'''External settings''' (usually changed more frequently than internal settings) ::The plugboard connections (''Steckerverbindungen'' or "stecker values"). ::The initial positions of each rotor at the start of enciphering the message (the "message key") or the rotor positions at the start of enciphering the message key (''Grundstellung'' or "indicator-setting") from which the message key could be derived. ===Key setting=== Enigma featured the major operational convenience of being [[involution (mathematics)|symmetrical]] (or [[Inverse function|self-inverse]]). This meant that [[decipherment]] worked in the same way as [[encryption|encipherment]], so that when the [[ciphertext]] was typed 