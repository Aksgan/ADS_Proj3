computer with <tt>GPEdit.msc</tt> or to a domain with <tt>gpmc.msc</tt>. It may be necessary to either logout or restart the computer in order for any Registry changes to take effect. === Evaluation order === The <tt>NoDriveAutoRun</tt> and <tt>NoDriveTypeAutoRun</tt> Registry entries can exist in two places, the per-user setting (under HKEY_CURRENT_USER) and the per-machine setting (under HKEY_LOCAL_MACHINE). If an entry appears under HKEY_LOCAL_MACHINE, then any corresponding entry under HKEY_CURRENT_USER is completely ignored. The data values are not merged in any way. When deciding whether to activate AutoRun, both <tt>NoDriveAutoRun</tt> and <tt>NoDriveTypeAutoRun</tt> Registry entries are consulted. If either value indicates a drive should be disabled then AutoRun is disabled for that drive. Thus in the following example: {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- ! colspan="2" | HKEY_LOCAL_MACHINE !! colspan="2" | HKEY_CURRENT_USER |- ! NoDriveAutoRun !! NoDriveTypeAutoRun !! NoDriveAutoRun !! NoDriveTypeAutoRun |- | <center> 0x08 </center> | <center> (Not Present) </center> | <center> 0x03FFFFFF </center> | <center> 0x95 </center> |} the data value taken for <tt>NoDriveAutoRun</tt> is 0x08, disabling drive D and the data value taken for <tt>NoDriveTypeAutoRun</tt> is 0x95, disabling removable and network drives. The per-user <tt>NoDriveAutoRun</tt> entry is never used. === NoDriveTypeAutoRun === {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="4" | <tt>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> <br> <tt>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> |- ! Entry name !! Data type !! Range !! Default |- | <tt>NoDriveTypeAutoRun</tt> | <center> REG_DWORD </center> | <center> 0x00 to 0xFF </center> | <center> 0x95 or 0x91 </center> |} This Registry entry disables or enables the AutoRun feature on all drives of the type specified.<ref name=reg_nodtar>[http://technet.microsoft.com/en-us/library/cc959381.aspx Windows 2000 Registry: NoDriveTypeAutoRun], Microsoft, ''[[Microsoft TechNet|TechNet]]''</ref> It reflects the setting of the relevant Autoplay Group Policy. Valid data ranges from 0x00 to 0xFF in [[hexadecimal]] notation. If the entry is not present, the default data value is either 0x95 or 0x91 depending on the version of Windows used. An entry present in HKLM overrides any entry present in HKCU. The entry data is a bitmapped value, where a bit set to 1 disables AutoRun on a particular type of drive. The bit settings for each type of drive are shown below: :[[Image:NoDriveTypeAutoRun bit settings.gif|none|drive type bitwise settings]] Note that bit number 1 is unused and that the "Unknown" type is represented twice. Setting all bits to 1 would give a hexadecimal value of 0xFF, decimal 255, and would disable AutoRun on all types of drives. The default setting for this entry depends on the version of Windows being used:<ref name=inftest/><ref name=kb967715>[http://support.microsoft.com/kb/967715 How to disable the Autorun functionality in Windows], Microsoft, ''Knowledge Base''</ref> {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- ! Operating system !! Default setting |- | Windows 7 || <center> 0x91 </center> |- | Windows Server 2008 || <center> 0x91 </center> |- | Windows Vista || <center> 0x91 </center> |- | Windows Server 2003 || <center> 0x95 </center> |- | Windows XP || <center> 0x91 </center> |- | Windows 2000 || <center> 0x95 </center> |- | Windows 95/98 || <center> 0x95 </center> |} === NoDriveAutoRun === {| class="wikitable" style="margin:1.5em 1em 1.5em 2em;" |- | colspan="4" | <tt>HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> <br> <tt>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</tt> |- ! Entry name !! Data type !! Range !! Default |- | <tt>NoDriveAutoRun</tt> | <center> REG_DWORD </center> | <center> 0x0 to 0x03FFFFFF </center> | <center> 0x0 </center> |} This Registry entry disables or enables the AutoRun feature on individual drives.<ref name=reg_nodar>[http://technet.microsoft.com/en-us/library/cc959387.aspx Windows 2000 Registry: NoDriveAutoRun], Microsoft, ''TechNet''</ref> It is not associated with a Group Policy and does not exist by default. The data value is taken to be 0 if the entry is not present. An entry present in HKLM overrides any entry present in HKCU. The data is a 32 bit (DWORD) bitmapped value, of which the lower 26 bits are used to represent each of the 26 drive letters from A to Z. Thus the valid data range is from 0x0 to 0x03FFFFFF. The least significant bit (the right most bit) represents drive A, and the 26th bit from the right represents drive Z. A bit set to 1 disables AutoRun on a particular drive. For example, if the data value is set to 0x8 (1000 binary), AutoRun is disabled on drive D. == Group Policy == [[Image:Group Policy Turn off Autoplay.gif|thumb|The Group Policy settings dialog]] The only Group Policy settings available for AutoRun affect the <tt>NoDriveTypeAutoRun</tt> Registry entries. The policy is available on either a per-machine or a per-user basis reflecting the Registry entry location in either HKLM or HKCU.<ref name=reg_nodtar/><ref name=reg_nodar/> As described [[#Evaluation order|above]], a per-machine policy setting will cause the per-user policy setting to be ignored. When a policy is ''Enabled'', Group Policy will add the <tt>NoDriveTypeAutoRun</tt> entry to the Registry. If the policy is ''Disabled'' or set to ''Not configured'', Group Policy deletes this entry from the Registry. System defaults may then take effect as described in the [[#NoDriveTypeAutoRun|NoDriveTypeAutoRun]] section. The policy names, locations and possible settings vary slightly between Windows versions. The list of settings are relatively short and are always additional to the system default setting. Therefore, on Windows 2000, enabling the "Disable Autoplay" policy and setting it to "CD-ROM drives", disables AutoRun (as distinct from AutoPlay) for CD-ROM and DVD drives, removable drives, network drives, and drives of unknown type. This setting cannot be used to enable AutoRun on drives on which it is disabled by default or disable AutoRun for drives not listed. To disable or enable any particular drives or drive types, the Registry must be edited manually. === Windows Server 2003, Windows XP, and Windows 2000 === The per-machine policy location is: : Group Policy \ Computer Configuration \ Administrative Templates \ System The per-user policy location is: : Group Policy \ User Configuration \ Administrative Templates \ System The relevant policy is "Turn off Autoplay". In Windows 2000 the policy is called "Disable Autoplay" instead. Once the policy is Enabled it can be set to "All drives" or "CD-ROM drives". The latter setting adds CD-ROM drives to the existing list of disabled drive types as described above. === Windows Vista, Windows Server 2008 === The per-machine policy location is:<ref>[http://technet.microsoft.com/en-us/library/bb629455.aspx Windows Vista 