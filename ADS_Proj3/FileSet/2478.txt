are used. Chapter 13 of Pope<ref name="Pope_2000" /> addresses the question of how fine a grid resolution <math>\Delta x</math> is needed to resolve a filtered velocity field <math>\overline{u}(\boldsymbol{x})</math>. Ghosal<ref name="Ghosal_1996">{{cite journal |title=An analysis of numerical errors in large-eddy simulations of turbulence |author=Ghosal, S. |year=1996 |month=April |journal=[[Journal of Computational Physics]] |volume=125 |issue=1 |doi=10.1006/jcph.1996.0088}}</ref> found that for low-order discretization schemes, such as those used in finite volume methods, the truncation error can be the same order as the subfilter scale contributions, unless the filter width <math>\Delta</math> is considerably larger than the grid spacing <math>\Delta x</math>. While even-order schemes have truncation error, they are non-dissipative,<ref name="Leveque_1992">{{cite book |title=Numerical Methods for Conservation Laws |author=Randall J. Leveque |year=1992 |publisher=Birkhäuser Basel |edition=2nd |isbn=978-3764327231}}</ref> and because subfilter scale models are dissipative, even-order schemes will not affect the subfilter scale model contributions as strongly as dissipative schemes. === Filter implementation === The filtering operation in large eddy simulation can be implicit or explicit. Implicit filtering recognizes that the subfilter scale model will dissipate in the same manner as many numerical schemes. In this way, the grid, or the numerical discretization scheme, can be assumed to be the LES low-pass filter. While this takes full advantage of the grid resolution, and eliminates the computational cost of calculating a subfilter scale model term, it is difficult to determine the shape of the LES filter that is associated with some numerical issues. Additionally, truncation error can also become an issue.<ref name="Grinstein_2007">{{cite book |title=Implicit large eddy simulation |author1=Grinstein, Fernando |author2=Margolin, Len |author3=Rider, William |year=2007 |publisher=Cambridge University Press |isbn=978-0-521-86982-9}}</ref> In explicit filtering, an [[Filter (large eddy simulation)|LES filter]] is applied to the discretized Navier-Stokes equations, providing a well-defined filter shape and reducing the truncation error. However, explicit filtering requires a finer grid than implicit filtering, and the computational cost increases with <math>(\Delta x)^4</math>. Chapter 8 of Sagaut (2006) covers LES numerics in greater detail.<ref name="Sagaut_2006" /> == Modeling Unresolved Scales == To discuss the modeling of unresolved scales, first the unresolved scales must be classified. They fall into two groups: '''resolved sub-filter scales''' (SFS), and '''sub-grid scales'''(SGS). The resolved sub-filter scales represent the scales with wave numbers larger than the cutoff wave number <math>k_c</math>, but whose effects are dampened by the filter. Resolved sub-filter scales only exist when filters non-local in wave-space are used (such as a [[Filter (large eddy simulation)#Box_filter|box]] or [[Filter (large eddy simulation)#Gaussian_filter|Gaussian]] filter). These resolved sub-filter scales must be modeled using filter reconstruction. Sub-grid scales are any scales that are smaller than the cutoff filter width <math>\Delta</math>. The form of the SGS model depends on the filter implementation. As mentioned in the [[#Numerical methods for LES|Numerical methods for LES]] section, if the filter is implicit, there is no SGS model implemented. Only explicit filters require SGS models. === Sub-grid scale models === Without a universally valid description of turbulence, some empirical information must be utilized when constructing and applying SGS models. Two classes of SGS models exist; the first class is '''functional models''' and the second class is '''structural models'''. Some models may be categorized as both. === Functional (Eddy-Viscosity) Models === Functional models are simpler than structural models, focusing only on dissipating energy at a rate that is physically correct. These are based on an artificial eddy viscosity approach, where the effects of turbulence are lumped into a turbulent viscosity. The approach treats dissipation of kinetic energy at sub-grid scales as analogous to molecular diffusion. In this case, the deviatoric part of <math>\tau_{ij}</math> is modeled as: :<math> \tau_{ij} - \frac{1}{3} \tau_{kk} \delta_{ij} = -2 \nu_{T} \bar{S}_{ij} </math> where <math>\nu_{T}</math> is the turbulent eddy viscosity and <math>\bar{S}_{ij} = \frac{1}{2} \left( \frac{\partial \bar{u}_i }{\partial x_j} + \frac{\partial \bar{u}_j}{ \partial x_i} \right)</math> is the rate-of-strain tensor. Based on dimensional analysis, the eddy viscosity must have units of <math>\left[ \frac{ \text{length}^2 }{ \text{time} } \right]</math>. Most eddy viscosity SGS models model the eddy viscosity as the product of a characteristic length scale and a characteristic velocity scale. ====Smagorinsky-Lilly model==== The first SGS model developed was the Smagorinsky-Lilly SGS model, which was developed by [[Joseph Smagorinsky|Smagorinsky]]<ref name="Smagorinsky_1963" /> and used in the first LES simulation by Deardorff<ref name="Deardorff_1970" />. It models the eddy viscosity as: :<math>\nu_T = (C_s \Delta_g)^2\sqrt{2\bar{S}_{ij}\bar{S}_{ij}} = (C_s \Delta_g)^2 \left| S \right| </math> where <math>\Delta_g</math> is the grid size and <math>C_s</math> is a constant. This method assumes that the energy production and dissipation of the small scales are in equilibrium - that is, <math>\epsilon = \Pi</math>. ====Germano dynamic model==== Germano et al.<ref name="Germano_1991">{{cite journal |title=A dynamic subgrid‐scale eddy viscosity model |author1=Germano, M. |author2=Piomelli, U. |author3=[[Parviz Moin|Moin, P.]] |author4=Cabot, W. |journal=[[Physics of Fluids|Physics of Fluids A]] |volume=3 |pages=1760–1765 |year=1991 |doi=doi:10.1063/1.857955}} </ref> identified a number of studies using the Smagorinsky model that each found different values for the Smagorinsky constant <math>C_s</math> for different flow configurations. In an attempt to formulate a more universal approach to SGS models, Germano et al. proposed a dynamic Smagorinsky model, which utilized two filters: a grid LES filter, denoted <math>\overline{\cdot}</math>, and a test LES filter, denoted <math>\hat{\cdot}</math>. In this case, the resolved turbulent stress tensor <math>\mathcal{L}_{ij}</math> is defined as :<math> \mathcal{L} = T_{ij}^{r} - \hat{\tau}_{ij}^{r} </math> which is also called the Germano identity. The quantity <math>T_{ij}^r = \widehat{\overline{u_i u_j}} - \hat{\bar{u}}_i \hat{\bar{u}}_j</math> is the residual stress tensor for the test filter, and <math>\hat{\tau}_{ij}^{r} = \widehat{ \overline{u}_i \overline{u}_j } - \widehat{ \overline{ u_i u_j }}</math> is the residual stress tensor for the grid filter. <math>\mathcal{L}_{ij}</math> represents the contribution to the SGS stresses by length scales smaller than the test filter width <math>\hat{\Delta}</math> but larger than the grid filter width <math>\overline{\Delta}</math>. This allows the value of the Smagorinsky model to adapt to the instantaneous state of the flow.<reference name="Germano_1991" /> The dynamic SGS model yields an equation for <math>C_s</math>: :<math> C_{s}^{2} = \frac{ \mathcal{L}_{ij} \mathcal{M}_{ij} }{ \mathcal{M}_{ij} \mathcal{M}_{ij} } </math> where <math>\mathcal{M}_{ij} = 2 \overline{\Delta}^2 \left( \overline{ \left| \hat{S} \right| \hat{S}_{ij} } - \alpha^2 \left| \overline{\hat{S}} \right| \overline{\hat{S}}_{ij} \right)</math> and <math>\alpha = \hat{\Delta} / \overline{\Delta}</math>. However, this procedure was numerically unstable, and additionally finding the value of <math>C_s</math> was 