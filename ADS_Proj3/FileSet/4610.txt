a controller at one end of the link to change the power modes of both the forward and reverse directions of the link. This means that a controller situated at one end of the link can change the power mode of both link directions in a single atomic operation. The intricate steps required for doing this in a fully reliable way are handled transparently within L1.5. ===L1.5 guarantees=== This layer provides a number of features, but only a few guarantees: * after reset, each L1.5 transmitter will wait until the connected L1.5 receiver is known to be active (handled via a handshake) * if more than one lane is used, the ordering of the original symbol stream is preserved (despite usage of multiple lanes and freedom on how to interconnect these lanes) * power mode changes are executed reliably (even in the presence of bit errors) ==Data Link Layer (L2)== The main task of UniPro's Data Link layer (L2) is to allow reliable communication between two adjacent nodes in the network - despite occasional bit errors at the Physical layer or potential link congestion if the receiver cannot absorb the data fast enough. ===L2 data frames=== L2 clusters 17-bit UniPro L1.5 symbols into packet-like data frames (the term packet is reserved for L3). These data frames start with a 17-bit start-of-frame control symbol, followed by up to 288 bytes of data (144 data symbols) and followed by an end-of-frame control symbol and a checksum. Note that two or more of the 288 bytes are used by higher layers of the UniPro protocol. The maximum frame size of 288 payload bytes per frame was chosen to ensure that the entire protocol stack could easily transmit 256 bytes of application data in a single chunk. Payloads consisting of odd numbers of bytes are supported by padding the frame to an even number of bytes and a corresponding flag in the trailer. {| border="1" cellpadding="3" style="margin: 1em auto 1em auto" |+ ''Example UniPro Data Frame'' |- style="background:#D8D8D8; color:black" | align="center background:#FF1804;" | ctl || b15 || b14 || b13 || b12 || b11 || b10 || b09 || b08 || b07 || b06 || b05 || b04 || b03 || b02 || b01 || b00 |- style="background:#FF9400; color:black" align="center" | style="background:#FF1804; color:white" | 1 | colspan="16" | Start-of-Data-Frame control symbol (header) |- style="background:#F8F8F8; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | Frame payload |- style="background:#F8F8F8; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | : |- style="background:#F8F8F8; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | : |- style="background:#F8F8F8; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | Frame payload |- style="background:#FF9400; color:black" align="center" | style="background:#FF1804; color:white" | 1 | colspan="16" | End-of-Data-Frame control symbol (trailer) |- style="background:#FF9400; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | 16-bit checksum |} ===L2 control frames=== In addition to data frames which contain user data, L2 also transmits and receives control frames. The control frames can be distinguished from data frames by three bits in the first symbol. There are two types of control frames: * One type ("AFC", 3 symbols) serves to acknowledge successfully received data frames. * The other type ("NAC", 2 symbols) notifies the corresponding transmitter that an incorrect frame has been received. Note that these L2 types of control frames are sent autonomously by L2. {| border="1" cellpadding="3" style="margin: 1em auto 1em auto" |+ ''Example UniPro Control Frame'' |- style="background:#D8D8D8; color:black" | align="center background:#FF1804;" | ctl || b15 || b14 || b13 || b12 || b11 || b10 || b09 || b08 || b07 || b06 || b05 || b04 || b03 || b02 || b01 || b00 |- style="background:#FF9400; color:black" align="center" | style="background:#FF1804; color:white" | 1 | colspan="16" | Start-of-Control-Frame control symbol (header) |- style="background:#FF9400; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | Control frame payload (AFC only) |- style="background:#FF9400; color:black" align="center" | style="background:#FF1804; color:white" | 0 | colspan="16" | 16-bit checksum |} ===L2 retransmission=== High speed communication at low power levels can lead to occasional errors in the received data. The Data Link layer contains a protocol to automatically acknowledge correctly received data frames (using AFC control frames) and to actively signal errors that can be detected at L2 (using NAC control frames). The most likely cause of an error at L2 is that a data frame was corrupted at the electrical level (noise, EMI). This results in an incorrect data or control frame checksum at the receiver side and will lead to its automatic retransmission. Note that data frames are acknowledged (AFC) or negatively acknowledged (NAC). Corrupt control frames are detected by timers that monitor expected or required responses. A bandwidth of 1 Gbit/s and a bit-error rate of 10<sup>âˆ’12</sup> at a speed of 1 gigabit/s would imply an error every 1000 seconds or once very 1000 transmitted Gbit. Layer 2 thus automatically corrects these errors at the cost of marginal loss of bandwidth and at the cost of buffer space needed in L2 to store copies of transmitted data frames for possible retransmission or "replay". ===L2 flow control=== Another feature of L2 is the ability for an L2 transmitter to know whether there is buffer space for the data frame at the receiving end. This again relies on L2 control frames (AFC) which allow a receiver to tell the peer's transmitter how much buffer space is available. This allows the receiver to pause the transmitter if needed, thus avoiding receive buffer overflow. Control frames are unaffected by L2 flow control: they can be sent at any time and the L2 receiver is expected to process these at the speed at which they arrive. ===L2 Traffic Classes and arbitration=== UniPro currently supports two priority levels for data frames called Traffic Class 0 (TC0) and Traffic Class 1 (TC1). TC1 has higher priority than TC0. This means that if an L2 transmitter has a mix of TC0 and TC1 data frames to send, the TC1 data frames will be sent first. Assuming 