based,<ref name="washington">Washington, Lawrence C., '''Elliptic Curves: Number Theory and Cryptography''', Chapman & Hall/CRC, 2003</ref> where the group <math>(\mathbb{Z}/n\mathbb{Z})^*</math> is replaced by <math>E(\mathbb{Z}/n\mathbb{Z})</math>, and ''E'' is a properly chosen elliptic curve. We will now state a proposition on which to base our test, which is analogous to the Pocklington criterion, and gives rise to the Goldwasser-Kilian-Atkin form of the elliptic curve primality test. ==Proposition== Let ''N'' be a positive integer, and ''E'' be the set which is defined by the equation <math>y^2 = x^3 + ax + b \pmod{N}</math>. Consider ''E'' over <math>\mathbb{Z}/N\mathbb{Z}</math>, use the usual addition law on ''E'', and write O for the neutral element on ''E''. Let ''m'' be an integer. If there is a prime ''q'' which divides ''m'', and is greater than <math>(n^{1/4}+1)^2</math> and there exists a point ''P'' on ''E'' such that (1) ''mP'' = 0 (2) (''m''/''q'')''P'' is defined and not equal to 0 Then ''N'' is prime. ===Proof=== If ''N'' is composite, then there exists a prime <math>p \le \sqrt{N}</math> that divides ''N''. Define <math>E_p</math> as the elliptic curve defined by the same equation as ''E'' but evaluated modulo ''p'' rather than ''modulo N''. Define <math>m_p</math> as the order of the group <math>E_p</math>. By [[Hasse's theorem on elliptic curves]] we know : <math>m_p \le p+1+2\sqrt{p} = (\sqrt{p} + 1)^2 \le (n^{1/4} + 1)^2 < q</math> and thus <math>\gcd{(q,m_p)}=1</math> and there exists and integer ''u'' with the property that : <math>uq \equiv 1 \pmod{m_p}</math> Let <math>P_p</math> be the point ''P'' evaluated ''modulo p''. Thus, on <math>E_p</math> we have : <math>(m/q)P_p = uq(m/q)P_p = umP_p = 0 \, </math> by (1), as <math>mP_p</math> is calculated using the same method as ''mP'', except modulo ''p'' rather than modulo ''N'' (and <math>p \vert N</math>). This contradicts (2), because if (''m''/''q'')''P'' is defined and not equal to 0 (mod ''N''), then the same method calculated modulo ''p'' instead of ''modulo N'' will yield <math>(m/q)P_p \ne 0</math> <ref name="koblitz">Koblitz, Neal, '''Introduction to Number Theory and Cryptography''', 2nd Ed, Springer, 1994</ref> ==Goldwasser–Kilian algorithm== From this proposition an algorithm can be constructed to prove an integer, ''N'', is prime. This is done as follows: Choose three integers at random, ''a, x, y'' and set : <math>b \equiv y^2 - x^3 - ax \pmod{N}</math> Now ''P'' = (''x'',''y'') is a point on ''E'', where we have that ''E'' is defined by <math>y^2 = x^3 + ax + b</math>. Next we need an algorithm to count the number of points on ''E''. Applied to ''E'', this algorithm (Koblitz and others suggest [[Schoof's algorithm]]) produces a number ''m'' which is the number of points on curve ''E'' over '''F<sub>''N''</sub>''', provided ''N'' is prime. Next we have a criterion for deciding whether our curve ''E'' is acceptable. If we can write ''m'' in the form <math>m = kq</math> where <math> k \ge 2 </math> is a small integer and ''q'' a probable prime (it has passed some previous probabilistic [[primality test]], for example), then we do not discard ''E''. If it is not possible to write ''m'' in this form, we discard our curve and randomly select another triple ''(a, x, y)'' to start over. Assuming we find a curve which passes the criterion, proceed to calculate ''mP'' and ''kP''. If at any stage in the calculation we encounter an undefined expression (from calculating the multiples of ''P'' or in our point counting algorithm), it gives us a non-trivial factor of ''N''. If <math>mP \neq 0</math> it is clear that ''N'' is not prime, because if ''N'' were prime then ''E'' would have order ''m'', and any element of ''E'' would become ''0'' on multiplication by ''m''. If ''kP = 0'' then we have hit a dead-end and must start again with a different triple. Now if <math>mP = 0</math> and <math>kP \neq 0 </math> then our previous proposition tells us that ''N'' is prime. However there is one possible problem, which is the primality of ''q''. This must be verified, using the same algorithm. So we have described a down-run procedure, where the primality of ''N'' can be proven through the primality of ''q'' and indeed smaller 'probable primes' until we have reached certain primes and are finished.<ref>http://www.mast.queensu.ca/~math418/m418oh/m418oh27.pdf</ref><ref name="BSS">Blake, Ian F., Seroussi, Gadiel, Smart, Nigel Paul, '''Elliptic Curves in Cryptography''', Cambridge University Press, 1999</ref> ==Problems with the algorithm== Atkin and Morain state "the problem with GK is that Schoof's algorithm seems almost impossible to implement.<ref name="atkin-morain"/> It is very slow and cumbersome to count all of the points on ''E'' using Schoof's algorithm, which is the preferred algorithm for the Goldwasser–Kilian algorithm. However, the original algorithm by Schoof is not effcicient enough to provide the number of points in short time.<ref name="lenstra">Lenstra, Hendrik W., ''Efficient Algorithms in Number Theory'', https://openaccess.leidenuniv.nl/bitstream/1887/2141/1/346_081.pdf</ref> These comments have to be seen in the historical context, before the improvements by Elkies and Atkin to Schoof's method. A second problem Koblitz notes is the difficulty of finding the curve ''E'' whose number of points is of the form ''kq'', as above. There is no known theorem which guarantees we can find a suitable ''E'' in polynomially many attempts. The distribution of primes on the Hasse interval <math>[p+1-2\sqrt{p},p+1+2\sqrt{p}]</math>, which contains ''m'', is not the same as the distribution of primes in the group orders, counting curves with multiplity. However, this is not a significant problem in practice.<ref name="koblitz"/> ==Atkin–Morain elliptic curve primality test (ECPP)== In a 1993 paper, Atkin and Morain described an algorithm ECPP which avoided the trouble of relying on a cumbersome point counting algorithm (Schoof's). The algorithm still relies on the proposition stated above, but rather than randomly generating elliptic curves and searching for a proper ''m'', their idea was to construct a curve ''E'' where the number of points is easy to compute. [[Complex multiplication]] is key in the construction of the curve. Now, given an ''N'' for which primality needs to be proven we need to find a suitable ''m'' and ''q'', just as in the Goldwasser-Kilian test, that will fulfill the proposition and prove the primality 