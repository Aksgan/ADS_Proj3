of its many appendices: For each bit encoded by the EBCOT coder, the improvement in image quality, defined as mean square error, gets measured; this can be implemented by an easy table-lookup algorithm. Furthermore, the length of the resulting code stream gets measured. This forms for each code block a graph in the rate–distortion plane, giving image quality over bitstream length. The optimal selection for the truncation points, thus for the packet-build-up points is then given by defining critical ''slopes'' of these curves, and picking all those coding passes whose curve in the rate–distortion graph is steeper than the given critical slope. This method can be seen as a special application of the method of ''[[Lagrange multiplier]]'' which is used for optimization problems under constraints. The [[Lagrange multiplier]], typically denoted by λ, turns out to be the critical slope, the constraint is the demanded target bitrate, and the value to optimize is the overall distortion. Packets can be reordered almost arbitrarily in the JPEG 2000 bit-stream; this gives the encoder as well as image servers a high degree of freedom. Already encoded images can be sent over networks with arbitrary bit rates by using a layer-progressive encoding order. On the other hand, color components can be moved back in the bit-stream; lower resolutions (corresponding to low-frequency sub-bands) could be sent first for image previewing. Finally, spatial browsing of large images is possible through appropriate tile and/or partition selection. All these operations do not require any re-encoding but only byte-wise copy operations. ===Performance=== [[Image:Lichtenstein jpeg2000 difference.png|thumb|right|256px|This image shows the (accentuated) difference between an image saved as JPEG 2000 (quality 50%) and the original.]] Compared to the previous JPEG standard, JPEG 2000 delivers a typical compression gain in the range of 20%, depending on the image characteristics. Higher-resolution images tend to benefit more, where JPEG-2000's spatial-redundancy prediction can contribute more to the compression process. In very low-bitrate applications, studies have shown JPEG 2000 to be outperformed<ref>{{Cite web | last = Halbach, Till | title = Performance comparison: H.26L intra coding vs. JPEG2000 |date = July 2002| url = http://etill.net/papers/jvt-d039.pdf | accessdate = 2008-04-22 }}</ref> by the intra-frame coding mode of H.264. Good applications for JPEG 2000 are large images, images with low-contrast edges — e.g., medical images. ==File format and code stream== Similar to JPEG-1, JPEG 2000 defines both a file format and a code stream. Whereas the latter entirely describes the image samples, the former includes additional meta-information such as the resolution of the image or the color space that has been used to encode the image. JPEG 2000 images should — if stored as files — be boxed in the JPEG 2000 file format, where they get the '''.jp2''' extender. The part-2 extension to JPEG 2000, i.e., ISO/IEC 15444-2, also enriches this file format by including mechanisms for animation or composition of several code streams into one single image. Images in this extended file-format use the '''.jpx''' extension. There is no standardized extension for code-stream data because code-stream data is not to be considered to be stored in files in the first place, though when done for testing purposes, the extension '''.jpc''' or '''.j2k''' appear frequently. ==Metadata== For traditional JPEG, additional [[metadata]], e.g. lighting and exposure conditions, is kept in an application marker in the [[Exchangeable image file format|Exif]] format specified by the JEITA. JPEG 2000 chooses a different route, encoding the same metadata in [[XML]] form. The reference between the Exif tags and the XML elements is standardized by the ISO TC42 committee in the standard 12234-1.4. [[Extensible Metadata Platform]] can also be embedded in JPEG 2000. ==Applications of JPEG 2000== Some markets and applications intended to be served by this standard are listed below: * Consumer applications such as multimedia devices (e.g., digital cameras, personal digital assistants, 3G mobile phones, color facsimile, printers, scanners, etc.) * Client/server communication (e.g., the Internet, Image database, Video streaming, video server, etc.) * Military/surveillance (e.g., HD satellite images, Motion detection, network distribution and storage, etc.) * Medical imagery, esp. the [[DICOM]] specifications for medical data interchange. * [[Remote sensing]] * High-quality frame-based video recording, editing and storage. * [[Digital cinema]] * JPEG 2000 has many design commonalities with the [[ICER]] image compression format that is used to send images back from the [[Mars]] rovers. * [[World Meteorological Organization]] has built JPEG 2000 Compression into the new GRIB2 file format. The GRIB file structure is designed for global distribution of meteorological data. The implementation of JPEG 2000 compression in GRIB2 has reduced file sizes up to 80%.<ref>[http://www.cpc.ncep.noaa.gov/products/wesley/wgrib2/ wgrib2 home page]</ref> ==Comparison with PNG== Although JPEG 2000 format supports lossless encoding, it is not intended to completely supersede today's dominant lossless image file formats. The [[Portable Network Graphics|PNG]] (Portable Network Graphics) format is still more space-efficient in the case of images with many pixels of the same color, such as diagrams, and supports special compression features that JPEG 2000 does not. ==Legal issues== JPEG 2000 is by itself licensed, but the contributing companies and organizations agreed that licenses for its first part—the core coding system—can be obtained free of charge from all contributors. The JPEG committee has stated: :It has always been a strong goal of the JPEG committee that its standards should be implementable in their baseline form without payment of royalty and license fees... The up and coming JPEG 2000 standard has been prepared along these lines, and agreement reached with over 20 large organizations holding many patents in this area to allow use of their intellectual property in connection with the standard without payment of license fees or royalties.<ref>[http://www.jpeg.org/newsrel1.html JPEG 2000 Concerning recent patent claims]</ref> However, the JPEG committee has also noted that undeclared and obscure [[submarine patent]]s may still present a hazard: :It is of course still possible that other organizations or individuals may claim intellectual property rights that affect implementation of the standard, and any implementers are urged to carry out their own searches and investigations in this area.<ref>[http://www.jpeg.org/jpeg2000/CDs15444.html JPEG 2000 Committee Drafts]</ref> Because of this statement, controversy remains 