calls. When an appropriately configured [[CD-ROM]] is inserted into a CD-ROM drive, Windows detects the arrival and checks the contents for a special file containing a set of instructions. For a commercial application, these instructions normally initiate installation of the software from the CD-ROM. To maximise the likelihood of installation success, AutoRun also acts when the drive is accessed ("[[double-click]]ed") in [[Windows Explorer]] (or "My Computer"). Until the introduction of [[Windows XP]], the terms AutoRun and AutoPlay were used interchangeably, developers often using the former term and end users the latter. This tendency is reflected in Windows Policy settings named AutoPlay that change Windows Registry entries named AutoRun, and in the [[autorun.inf]] file which causes "AutoPlay" to be added to drivesâ€™ [[context menu]]s. The terminology was of little importance until the arrival of Windows XP and its addition of a new feature to assist users in selecting appropriate actions when new media and devices were detected. This new feature was called ''AutoPlay'' and a differentiation between the two terms was created.<ref name=autoplaydiff>[http://windowshelp.microsoft.com/Windows/en-us/help/a19ac945-1007-4638-9615-e2c3bfd92b751033.mspx What's the difference between AutoPlay and AutoRun?], Microsoft, ''Windows Vista Help''</ref> == AutoRun == AutoRun, a feature of Windows Explorer (actually of the shell32 [[Dynamic Link Library|dll]]) introduced in Windows 95, enables media and devices to launch programs by use of commands listed in a file called <tt>[[autorun.inf]]</tt>, stored in the [[root directory]] of the medium. Primarily used on installation CD-ROMs, the applications called are usually application installers. The autorun.inf file can also specify an icon which will represent the device visually in Explorer along with other advanced features.<ref name=autoplaydiff/> The terms AutoRun and AutoPlay tend to be interchangeably used when referring to the initiating action, the action that detects and starts reading from discovered [[volume (computing)|volume]]s. The [[AutoPlay#From detection to application|flowchart illustration]] in the AutoPlay article shows how AutoRun is positioned as a layer between AutoPlay and the Shell Hardware Detection service and may help in understanding the terminology. However, to avoid confusion, this article uses the term AutoRun when referring to the initiating action. == AutoPlay == [[Image:AutoPlay.png|thumb|AutoPlay in [[Windows Vista]] ]] [[AutoPlay]] is a feature introduced in Windows XP which examines removable media and devices and, based on content such as pictures, music or video files, launches an appropriate application to play or display the content.<ref name=autoplaydiff/> If available, settings in an autorun.inf file can add to the options presented to the user. AutoPlay is based on a set of handler applications registered with the AutoPlay system. Each media type (Pictures, Music, Video) can have a set of registered handlers which can deal with playing or display that type of media. Each hardware device can have a default action occurring on discovery of a particular media type, or the AutoPlay dialog can prompt the user what action to take. == AutoRun activation == The AutoRun sequence starts with the initial discovery of a new device or new piece of media. Following this, notification of interested parties occurs, of which the Windows Explorer shell is of primary interest. After checking certain [[Windows Registry|Registry]] settings to see if AutoRun can proceed, parsing of an optional autorun.inf may occur and any necessary actions are taken.(not working) The initial sequence is handled much the same in every version of Windows from Windows 95. However, the way the autorun.inf file is read and acted upon and the level of integration of AutoRun with AutoPlay has changed significantly from the time AutoPlay was introduced in Windows XP until the present handling in [[Windows 7]]. === Initiation and notification === When a device with AutoRun-compatible drivers receives new media, a "Media Change Notification" event occurs. The Windows [[operating system|OS]] then notifies interested applications that a device change has occurred. The notification method used can change depending on the device type. If the device changed is a volume (like a CD) or a port (like a serial port) Windows broadcasts a <tt>WM_DEVICECHANGE</tt> notification to all top level windows.<ref>[http://support.microsoft.com/kb/q163503/ How to receive notification of CD-ROM insertion or removal], Microsoft, ''Knowledge Base''</ref><ref>[http://msdn.microsoft.com/en-us/library/aa363215(VS.85).aspx Detecting media insertion or removal], Microsoft, ''[[Microsoft Developer Network|MSDN]] Library''</ref> Windows calls this a "basic" notification. A top level window is one which is a descendant of the desktop. However, if the device changed is not one of these types an application can use the <tt>RegisterDeviceNotification</tt><ref>[http://msdn.microsoft.com/en-us/library/aa363431(VS.85).aspx RegisterDeviceNotification function], Microsoft, ''MSDN Library''</ref> function to register to receive device notifications. <blockquote> An article on the CodeProject website, [http://www.codeproject.com/KB/system/HwDetect.aspx "Detecting Hardware Insertion and/or Removal"], with [http://blogs.msdn.com/doronh/archive/2006/02/15/532679.aspx clarifications] from a [[Weblog|blog]] by Doran Holan is of particular technical interest here. </blockquote> Non-volume devices are those devices that do not appear as drive letters in "My Computer". These are not handled by any part of AutoRun - any actions taken for these devices are taken either by device specific software or by AutoPlay. See [[AutoPlay#Devices that are not drives]]. When Explorer receives notification of a ''volume'' change, it performs a number of actions:<ref name=appcreate>[http://msdn.microsoft.com/en-us/library/cc144206(VS.85).aspx Creating an AutoRun-Enabled Application], Microsoft, ''MSDN Library''</ref><ref name=enadis>[http://msdn.microsoft.com/en-us/library/cc144204(VS.85).aspx Enabling and Disabling AutoRun], Microsoft, ''MSDN Library''</ref> <ol> <li> Checks to see if AutoRun has been disabled through the Registry. If AutoRun is disabled for that drive or drive type, Explorer does not proceed further. There have been [[#The AutoRun disable bug|bugs]] in this area. </li> <li> Checks that the root directory of the inserted media contains an autorun.inf file, which might be read. See [[#Changing behaviour|below]]. </li> <li> Sends a <tt>QueryCancelAutoPlay</tt> message to the foreground window. An application which has registered its interest in receiving this message using <tt>RegisterWindowMessage</tt> can respond to this message to halt AutoRun (and thus AutoPlay) at this point. Any application, foreground or not, can also be notified by using the <tt>IQueryCancelAutoPlay</tt> [[Component Object Model|COM]] interface<ref>[http://msdn.microsoft.com/en-us/library/bb761373(VS.85).aspx IQueryCancelAutoPlay Interface], Microsoft, ''MSDN Library''</ref> available in Windows XP and later. </li> <li> Alters [[double-click]] and contextual menu behaviours. When a user double clicks on the drive icon in Explorer or right clicks to get a context menu, what happens is fully programmable by settings in the autorun.inf file. </li> <li> Adds an autorun.inf controllable 