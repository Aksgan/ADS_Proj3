[[Mac OS X]] appeared in 2009,<ref>{{cite conference |url=http://www.blackhat.com/presentations/bh-usa-09/DAIZOVI/BHUSA09-Daizovi-AdvOSXRootkits-SLIDES.pdf|format=PDF|title=Advanced Mac OS X Rootkits|first=Dino|last=Dai Zovi|publisher=Endgame Systems|conference=[[Black Hat Briefings|Blackhat]]|accessdate=2010-11-23|date=2009-07-26}}</ref> while the [[Stuxnet]] worm was the first to target [[programmable logic controller]]s (PLC).<ref>{{cite web|url=http://www.symantec.com/connect/blogs/stuxnet-introduces-first-known-rootkit-scada-devices|title=Stuxnet Introduces the First Known Rootkit for Industrial Control Systems|date=2010-08-06|accessdate=2010-12-04|publisher=[[Symantec]]}}</ref> === Sony BMG copy protection rootkit scandal === {{main|Sony BMG copy protection rootkit scandal}} In 2005, [[Sony BMG]] published [[compact disc|CDs]] with [[copy protection]] and [[digital rights management]] software called [[Extended Copy Protection]], created by software company [[First 4 Internet]]. The software included a music player but silently installed a rootkit which limited the user's ability to access the CD.<ref name="CA-XCP">{{cite web |url=http://www.ca.com/us/securityadvisor/pest/pest.aspx?id=453096362 |publisher=[[Computer Associates]] |date=2005-11-05 |title=Spyware Detail: XCP.Sony.Rootkit |accessdate=2010-08-19 }}</ref> Software engineer [[Mark Russinovich]], who created the rootkit detection tool [[RootkitRevealer]], discovered the rootkit on one of his computers.<ref name="McAfee1"/> The ensuing scandal raised the public's awareness of rootkits.<ref name="markrussinovich">{{cite web |url=http://blogs.technet.com/b/markrussinovich/archive/2005/10/31/sony-rootkits-and-digital-rights-management-gone-too-far.aspx |title=Sony, Rootkits and Digital Rights Management Gone Too Far |last=Russinovich |first=Mark |authorlink=Mark Russinovich |publisher=[[Microsoft]] |work=[[Microsoft Technet#Blogs|TechNet Blogs]] |date=2005-10-31 |accessdate=2010-08-16 }}</ref> To cloak itself, the rootkit hid from the user any file starting with "$sys$". Soon after Russinovich's report, malware appeared which took advantage of that vulnerability of affected systems.<ref name="McAfee1"/> One [[BBC]] analyst called it a "public relations nightmare."<ref>{{ cite news |url=http://news.bbc.co.uk/2/hi/technology/4456970.stm |title=Sony's long-term rootkit CD woes |date= 2005-11-21 |accessdate=2008-09-15 |publisher=BBC News }}</ref> Sony BMG released [[patch (computing)|patches]] to [[uninstaller|uninstall]] the rootkit, but it exposed users to an even more serious vulnerability.<ref name=felton>{{cite web |url=http://www.freedom-to-tinker.com/?p=927 |title=Sony's Web-Based Uninstaller Opens a Big Security Hole; Sony to Recall Discs |date=2005-11-15 |first=Ed |last=Felton }}</ref> The company eventually recalled the CDs. In the United States, a [[class action|class-action lawsuit]] was brought against Sony BMG.<ref>{{cite journal | url = http://www.newscientist.com/article/dn8307 | title = Sony BMG sued over cloaking software on music CD | last = Knight | first = Will | date = 2005-11-11 | journal = New Scientist | publisher = Reed Business Information | location = Sutton, UK | accessdate = 2010-11-21 }}</ref> ==Uses== Modern rootkits do not elevate access,<ref name="Symantec"/> but rather are used to make another software payload undetectable by adding stealth capabilities.<ref name="Hoglund">{{cite book|url=http://books.google.com/books?id=fDxg1W3eT2gC|title=Rootkits: Subverting the Windows kernel|author=Greg Hoglund, James Butler|publisher=Addison-Wesley|year=2006|page=4|isbn=0321294319}}</ref> Most rootkits are classified as [[malware]], because the payloads they are bundled with are malicious. For example, a payload might covertly steal user [[password]]s, [[credit card]] information, computing resources, or conduct other unauthorized activities. A small number of rootkits may be considered utility applications by their users: for example, a rootkit might cloak a [[CD-ROM]]-emulation driver, allowing [[video game]] users to defeat [[anti-piracy]] measures that require insertion of the original installation media into a physical optical drive to verify that the software was legitimately purchased. Rootkits and their payloads have many uses: *Provide an attacker with full access via a [[Backdoor (computing)|backdoor]], permitting unauthorized access to, for example, steal or falsify documents. One of the ways to carry this out is to subvert the login mechanism, such as the /bin/login program on [[Unix-like]] systems or [[Graphical identification and authentication|GINA]] on Windows. The replacement appears to function normally, but also accepts a secret login combination that allows an attacker direct access to the system with administrative privileges, bypassing standard [[authentication]] and [[authorization]] mechanisms. *Conceal other [[malware]], notably password-stealing [[Keystroke logging|key loggers]] and [[computer virus]]es.<ref>{{cite journal |last=Russinovich |first=Mark |authorlink=Mark Russinovich |title=Unearthing Root Kits |magazine=''[[Windows IT Pro]]'' |month=June |year=2005 |url=http://www.windowsitpro.com/Article/ArticleID/46266/46266.html |accessdate=2010-12-16 }}</ref> *Appropriate the compromised machine as a [[zombie computer]] for attacks on other computers. (The attack originates from the compromised system or network, instead of the attacker's system.) "Zombie" computers are typically members of large [[botnet]]s that can launch [[denial-of-service attack]]s and distribute [[e-mail]] [[spam (electronic)|spam]]. *Enforcement of [[digital rights management]] (DRM). In some instances, rootkits provide beneficial functionality, and may be installed intentionally by the computer owner: *Conceal [[cheating in online games]] from software like [[Warden (software)|Warden]].<ref>{{cite news|url=http://www.theregister.co.uk/2005/11/04/secfocus_wow_bot/|title=World of Warcraft Hackers Using Sony BMG Rootkit |date=2005-11-04|accessdate=2010-08-23|publisher=[[The Register]]}}</ref> *Detect attacks, for example, in a [[Honeypot (computing)|honeypot]].<ref>{{Cite journal|url=http://www.vividmachines.com/download/icsicceid.pdf|title=Using Rootkit Technology for Honeypot-Based Malware Detection|author=Steve Hanna|publisher=CCEID Meeting|month=September|year=2007|format=PDF}}</ref> *Enhance emulation software and security software.<ref>{{ cite web |url=http://www.sysinternals.com/blog/2006/02/using-rootkits-to-defeat-digital.html |title=Using Rootkits to Defeat Digital Rights Management |accessdate=2006-08-13 |last=Russinovich |first=Mark |authorlink=Mark Russinovich |date=6 February 2006 |work=Winternals |publisher=SysInternals |archiveurl=http://blogs.technet.com/markrussinovich/archive/2006/02/06/using-rootkits-to-defeat-digital-rights-management.aspx |archivedate=31 August 2006 }}</ref> [[Alcohol 120%]] and [[Daemon Tools]] are commercial examples of non-hostile rootkits used to defeat copy-protection mechanisms such as [[SafeDisc]] and [[SecuROM]]. [[Kaspersky]] antivirus software also uses techniques resembling rootkits to protect itself from malicious actions. It loads its own drivers to intercept system activity, and then prevents other processes from doing harm to itself. Its processes are not hidden, but cannot be terminated by standard methods. *Anti-theft protection: Laptops may have BIOS-based rootkit software that will periodically report to a central authority, allowing the laptop to be monitored, disabled or wiped of information in the event that it is stolen.<ref name="Ortega">{{cite conference | url = http://www.blackhat.com/presentations/bh-usa-09/ORTEGA/BHUSA09-Ortega-DeactivateRootkit-PAPER.pdf | title = Deactivate the Rootkit: Attacks on BIOS anti-theft technologies | last = Ortega | first = Alfredo | last2 = Sacco | first2= Anibal | date = 2009-07-24 | conference = Black Hat USA 2009 | conferenceurl = http://www.blackhat.com/html/bh-usa-09/bh-usa-09-archives.html | publisher = Core Security Technologies | accessdate = 2010-11-21 | type = PDF | location = Boston, Mass. }}</ref> *Bypassing [[Windows Product Activation]]<ref>{{cite paper|url=http://www.stoned-vienna.com/downloads/The%20Rise%20of%20MBR%20Rootkits%20&%20Bootkits%20in%20the%20Wild.pdf|format=PDF||date=2009-09-02|accessdate=2010-11-23|title=Stoned Bootkit: The Rise of MBR Rootkits & Bootkits inthe Wild|last=Kleissner|first=Peter| }}</ref> ==Types== There are at least five types of rootkit, ranging from those at the lowest level in firmware (with the highest privileges), through to the least privileged user-based variants that operate in [[kernel (computer science)|Ring 3]]. Hybrid combinations of these may occur spanning, for example, user mode and kernel mode.<ref name="anson-forensics"/> ===User-mode=== [[File:CPU ring scheme.svg|thumb|right|Computer security rings (Note that [[hypervisor|Ring &#x2011;1]] is not shown)]] User-mode rootkits run in [[Ring (computer security)|Ring 3]], along with other applications as user, rather than low-level system processes.<ref name="McAfee2"/> They have a number of possible installation vectors to intercept and modify the standard behavior of application programming interfaces (APIs). Some inject a [[dynamic linker|dynamically-linked]] library (such as a [[dynamic-link library|.DLL]] file on Windows, or a .dylib file on [[Mac OS X]]) into other processes, and 