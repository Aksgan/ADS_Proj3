has contributed to this ongoing security problem. Session hijacking has been an ongoing problem for web browser developers and security experts for at least 5 years [http://www.theinquirer.net/inquirer/news/1811527/fear-baa-firesheep] [http://catless.ncl.ac.uk/Risks/26.19.html#subj7]. ==Methods== There are four main methods used to perpetrate a session hijack. These are: * '''[[Session fixation]]''', where the attacker sets a user's session id to one known to him, for example by sending the user an email with a link that contains a particular session id. The attacker now only has to wait until the user logs in. * '''Session sidejacking''', where the attacker uses [[packet sniffing]] to read network traffic between two parties to steal the session [[Http cookie|cookie]]. Many web sites use [[Secure Sockets Layer|SSL]] encryption for [[Logging (computer security)|login]] pages to prevent attackers from seeing the password, but do not use encryption for the rest of the site once [[authenticate]]d. This allows attackers that can read the network traffic to intercept all the data that is submitted to the [[web server|server]] or web pages viewed by the client. Since this data includes the session [[HTTP cookie|cookie]], it allows him to impersonate the victim, even if the password itself is not compromised.<ref>{{cite web|url=http://news.bbc.co.uk/2/hi/technology/6929258.stm|publisher=[[BBC News]]|date=August 3, 2007|title=Warning of webmail wi-fi hijack}}</ref> Unsecured [[Wi-Fi]] [[Hotspot (Wi-Fi)|hotspots]] are particularly vulnerable, as anyone sharing the network will generally be able to read most of the web traffic between other nodes and the [[access point]]. * Alternatively, an attacker with physical access can simply attempt to steal the [[session key]] by, for example, obtaining the file or memory contents of the appropriate part of either the user's computer or the server. * '''[[Cross-site scripting]]''', where the attacker tricks the user's computer into running code which is treated as trustworthy because it appears to belong to the server, allowing the attacker to obtain a copy of the cookie or perform other operations. ==Prevention== Methods to prevent session hijacking include: * An open source solution is [http://arpon.sourceforge.net ArpON] "Arp handler inspectiON". It is a portable ARP handler which detects and blocks all Man In The Middle attacks through ARP poisoning and spoofing attacks with a static ARP inspection (SARPI) and dynamic ARP inspection (DARPI) approach on switched or hubbed [[LAN]]s with or without [[DHCP]]. This requires an agent on every host that is to be protected. * Use of a long random number or string as the [[session key]]. This reduces the risk that an attacker could simply guess a valid session key through trial and error or brute force attacks. * Regenerating the session id after a successful login. This prevents [[session fixation]] because the attacker does not know the session id of the user after he has logged in. * [[Encryption]] of the data passed between the parties; in particular the session key. This technique is widely relied-upon by web-based banks and other e-commerce services, because it completely prevents sniffing-style attacks. However, it could still be possible to perform some other kind of session hijack. * Some services make secondary checks against the identity of the user. For example, a web server could check with each request made that the IP address of the user matched the one last used during that session. This does not prevent attacks by somebody who shares the same IP address, however, and could be frustrating for users whose IP address is liable to change during a browsing session. * Alternatively, some services will change the value of the cookie with each and every request. This dramatically reduces the window in which an attacker can operate and makes it easy to identify whether an attack has taken place, but can cause other technical problems (for example, preventing the back button from working properly, on the web). * Users may also wish to log out of websites whenever they are finished using them.<ref>''See'' {{cite web|url=http://itc.virginia.edu/netbadge/logout.html|title=NetBadge: How To Log Out}}</ref><ref>''See also'' {{cite web|url=http://www.becardsmart.org.uk/always_log_out|title=Be Card Smart Online - Always log out}}</ref> ==Firesheep== Recently a firefox extension called [[Firesheep]] has exploited and made it easy for public wifi users to be attacked by session hijackers. Websites like [[Facebook]], [[Twitter]], and any that the user adds to their preferences allow the firesheep user to easily access private information from cookies and threaten the public wifi users personal property. ==See also== *[[HTTP Cookie]] *[[Cross-site request forgery]] *[[TCP sequence prediction attack]] ==References== <div class="small-references"> <references/> </div> [[Category:Computer network security]] [[Category:Web security exploits]] [[Category:Computer security exploits]] [[de:Session Hijacking]] [[hy:SideJacking]] [[pl:Session hijacking]] [[zh:会话劫持]]</text> </page> <page> <id>34052</id> <title>Session poisoning</title> <text>'''Session poisoning''' (also referred to as "Session data pollution" and "Session modification") is to [[Exploit (computer security)|exploit]] insufficient input validation in server applications which copies user input into [[Session (computer science)|session]] variables. The underlying vulnerability is a state management problem: shared state, [[Race hazard|race condition]], ambiguity in use or plain unprotected modifications of state values. Session poisoning have been demonstrated in server environments where different non-malicious applications (scripts) share the same session states but where usage differ, causing ambiguity and race conditions. Session poisoning have been demonstrated in scenarios where attacker is able to introduce malicious scripts into the server environment, which is possible if attacker and victim share a web host. ==Origins== Session poisoning was first discussed as a (potentially new) vulnerability class in [[Full disclosure |Full disclosure mailinglist]]. [http://archives.neohapsis.com/archives/fulldisclosure/2006-01/0414.html Alla Bezroutchko] inquired if "Session data pollution vulnerabilities in web applications" was a new problem in January 2006. This was however an old vulnerability previously noted by other; "this is a classic state management issue" - [http://archives.neohapsis.com/archives/fulldisclosure/2006-01/0459.html Yvan Boily]; "This is not new" - [http://archives.neohapsis.com/archives/fulldisclosure/2006-01/0423.html /someone]. Earlier examples of these vulnerabilities can be found in major security resources/archives such as [[Bugtraq]], e.g. *July 2001 [http://seclists.org/lists/bugtraq/2001/Jul/0569.html Serious security hole in Mambo Site Server version 3.0.X] by Ismael Peinado Palomo of reverseonline.com *September 2005 [http://seclists.org/lists/bugtraq/2005/Sep/0193.html PHP Session modification] by unknow (from uw-team) and adam_i It is however hard to find early references. This is mainly due to that no generally accepted vulnerability class name or search term for these issues existed previously; nor was it taught/discussed in popular secure web programming 