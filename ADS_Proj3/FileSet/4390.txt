example all have the same color attributes. '''Mode 2 (Graphic 2):''' 32×24 characters or 256×192 bitmap, with a 2-color limitation for each 8 pixel wide line inside a character. Popular hybrids exists. '''Mode 3 (Multicolor):''' 64×48 mode, very blocky and rarely used. Each 'pixel' can have its own color defined though, hence the name. Sprites are available as in screen modes 1 and 2. The TMS9918 has a fixed 16-color palette (actually 15 colors + transparent). ==Sprites== In modes 1, 2, and 3, the VDC can render sprites. There can be 32 monochrome sprites of either 8×8 or 16×16 pixels on screen, each sprite can have its own one color. There can be no more than 4 sprites on a single scanline; any additional sprites' horizontal pixels are dropped. Sprites with a higher priority are drawn first. The VDP reports in a status register the number of the first dropped sprite. The CPU can get around this limitation by rotating sprite priorities so that a different set of sprites is drawn on every frame. Instead of disappearing entirely, the sprites will flicker. This technique is known as sprite multiplexing. Automatic sprite movement is not handled by the VDC. What is done, in practice, is that the CPU will pick up on the VDC's 'vertical interrupt' - a standard VDC output, which is triggered automatically once every 50th or 60th of a second (depending on chip variant), at the start of the VBI (vertical blanking interval). The CPU then jumps to some sprite-handling routine in software, which in turn tells the VDC where to reposition the sprites. When two non-transparent pixels in any pair of sprites collide, the sprite collision flag is set. This is useful for triggering more advanced collision detection routines inside the software which can then determine the exact location and act upon it. Note that unlike the Atari 2600's [[Television Interface Adapter]] and the Commodore 64's [[MOS Technology VIC-II|VIC-II]], the VDC cannot tell the program which two sprites have collided, just that individual sprites have been involved in a collision. ==Screen mode 2 detail== Technically, mode 2 is a character mode with a colorful character set. The screen is vertically divided into three 256×64 pixel areas, each of which gets its own character set. By sequentially printing the characters 0 through 255 in all three areas, the program can simulate a graphics mode where each pixel can be set individually. However, the resulting [[framebuffer]] is non-linear. The program can also use three identical character sets, and then deal with the screen like a text mode with a colorful character set. Background patterns and sprites then consist of colorful characters. This was commonly used in games, because to fill/scroll the entire screen, only 32×24 bytes had to be moved. Games on other home computers such as the [[Commodore 64]] also worked on a character basis. The graphics can be drawn such that the 8×8 pixel borders are not too obvious, an art where [[Konami]] was particularly well known for their excellence. This is the TMS9918 screen mode 2 challenge: every 8×1 pixel area has two colors, foreground and background. They may be freely picked out of the 16 color palette. But within each 8×1 pixel area, only two different colors can exist. When manipulating the screen in BASIC with the LINE command, one easily could exceed the limit of max 2 colors per 8×1 area and end up with "[[Attribute clash|color spill]]". In comparison, the [[MOS Technology VIC-II]] used in the [[Commodore 64]] limited programmers to 4 colors per 4×8 fat-pixel area. This meant there was less local color pressure, but more global color pressure: while three of the 4 colors could be freely picked out of palette of 16, the remaining fourth was a universal background color. The TMS9918 does not have any scroll registers. Scrolling must be done in software. ==Tradeoffs used in games== Some games tried to get around the 8 pixel scroll limitation, by scrolling the character set itself. [[Parsec_(video_game)|Parsec]] (TI-99/4A) does this. [[Circus Charlie]] (MSX) scrolled horizontally, and hence bumped into the maximum of 2 colors per 8×1 area limit. The graphics were "monochrome-ish" and there were some glitches halfheartedly covered by sprites. [[Pippols]] (MSX) scrolled vertically. Because this isn't affected by the 8×1 area limit, the player character could walk along smoothly scrolling colorful flowers and other such graphical fourishes. However there aren't many distinct objects onscreen, because the character set is cut down by factor 8. Pippols seems to be even below that limit by some factor. When moving at full speed in [[Road Fighter]] (MSX, vertically scrolling racing game), the screen moves 8 pixels each frame. This results in a smooth scroller in spite of the 8 pixel jumps. For many games this scrolling speed is not feasible, though. In [[Knightmare (1986 video game)|Knightmare]] (MSX), the scene scrolls vertically so slowly that the 8 pixel jump doesn't disturb much. Zanac scrolls vertically fairly fast, but due to the soft backgrounds which you never collide with it is a minor issue. It is most problematic in [[Gradius|Nemesis]] ("[[R-Type]] style" horizontal space shooter). On the other hand, the Nemesis 2 backgrounds are really of "16 bit" beauty. ==Specifications== * Video RAM: 16 KB * Text modes: 40 × 24 and 32 × 24 * Resolution: 256 × 192 (15 colours + transparent) * Sprites: 32, 1 colour, max 4 per horizontal line ==Amateur's Tool== TMS9918 still has plenty of fans who nowadays create lots of PC tools for character design, sprite design and for converting true color images to screen 2. With respect to this latter application, it is worth to underline the use of dithering algorithms (e.g. [[Floyd-Steinberg]]) in order to overcome the color clash problem and the limitations of the fixed palette. For tools implementing dithering in screen 2 conversion look at: [http://msx.jannone.org/conv/ Online screen 2 converter] and to [http://www.msx.org/modules.php?op=modload&name=Downloads&file=index&req=visit&lid=859 Offline screen 2 converter + C sources] ==See also== * [[List of home computers by video hardware]] ==External links== *[http://emu-docs.org/VDP%20TMS9918/Datasheets/TMS9918.pdf 