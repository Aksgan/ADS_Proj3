and internal data are also mapped in from either the [[IDE64]] cartridge (28 KiB) or the additional RAM of the SuperCPU is used. The standard kernal memory locations at page zero and page two are handled in a kernal-compatible way; temporarily used memory is restored after the routines are finished. Beyond the kernal table IDEDOS has two new calls for bulk data handling (read/write) which allows much faster data transfer rates than the character-based I/O. The native file system is non-CBM style at the low level to allow partitions greater than 16 MiB. High-level features like the 16-character filenames or filetypes are retained. Due to complexity and memory requirements, the filesystem creation and consistency check is not part of the operating system, unlike [[Commodore DOS|CBM DOS]] or CMD DOS. Additional filesystems like [[ISO 9660]] or [[File Allocation Table|FAT]] are abstracted internally and mostly use the same routines for handling, thereby little difference is noticeable to user programs, except if some features are not fully implemented. The device handling is done by additional device numbers assigned to the new devices. The device numbers for IDEDOS devices are configurable and is normally in the range of 10–14. Over the years many programs assumed that there is only device 8 and don't allow selecting anything else; this can be worked around by temporary changing the used IDEDOS device number to 8. For standard devices, the original kernal routines are used, while IDEDOS devices use custom routines which closely imitate the results and behavior of kernal calls for floppy devices. Kernal calls not going through the vector table (most notably IEC bus-specific calls) present an incompatibility with those programs using them. Special features (like CD-ROM audio handling) are implemented by new channel 15 commands, while features not found on floppy drives follow the CMD style commands to allow programs to easily support a wider range of devices. Unlike intelligent external devices which have a separate processor (like 1541 with CBMDOS), IDEDOS runs on the host computer, thereby all disk routines block until finished. This rules out the use of "IRQ loaders" which are commonly used to speed up operation of serial bus peripherals. Interrupts are generally allowed while IDEDOS is running (they are disabled on rare time-critical operations), however the system was written to be non-[[Reentrant (subroutine)|reentrant]], just like the original kernal. ==Short history== In 1996 IDEDOS was born, as there was a need for a system to run the IDE64 1.1 card. It was created by Josef Souček (main code) and Tomáš Přibyl (File manager, Final cartridge monitor adaptation). Additional code came by Jan Vorlíček (BASIC extension), Jan Hlaváček (Duart PCLink). In 2000 Kajtár Zsolt added CDROM support, new setup code and lot of fixes. Due to limitations of the design the development of a completely rewritten version (0.90) was started by Kajtár Zsolt, which was not ready for general use before 2005. Meanwhile the old version reached 0.898b in 2004.Jun. In 2009 the 64 KiB limit for the system started to get tight, and the IDEDOS 0.91 beta was started to refactor the code to gain more space and internal flexibility. ==IDEDOS 0.898b== This was the last version of the old IDEDOS series. '''Device support''' * 2 ATA(PI) devices: hard disk, CompactFlash, CDROM, DVD * [[Universal asynchronous receiver/transmitter|Duart]] RS-232 card for PCLink * [[SuperCPU]] v1/v2 '''Filesystem''' * Custom filesystem called OFS 0.02 * Up to 8 GiB, [[Cylinder-head-sector|CHS]] addressing only, covers the whole disk * 16 character filenames. * Fixed file types of SEQ, PRG, USR. * Directories are supported. * Time stamping supported. * Files up to 4 GiB, sequential access only * [[ISO 9660]] filesystem support '''Fastload''' Built in [[fast loader]] supported devices: * [[Commodore 1541|1541]] as device 8 Fast load can be switched off in setup in case of incompatibility (non-1541 as device 8). Minimum interleave is 7, fast saver is only supported in manager, and uses an interleave of 8. [[PAL]]/[[NTSC]] compatible timing. '''PCLink''' Custom protocol, sequential access only. Supported devices: * PC64 parallel cable * Duart RS-232 '''Setup screen''' Includes clock with calendar, ability to set drive numbers, screen colours, auto boot, floppy fast loader, basic clock (TI$), power management, write retry, read-ahead and write cache drive settings, CDROM slow down option. '''BASIC extensions''' The BASIC extension includes disk handling commands (limited to IDEDOS devices), and adds some new error messages. Commands: * CD - change working directory * CDOPEN - open CDROM tray * CDCLOSE - close CDROM tray * CHANGE - change HDD device number * DATE - print date and time * DIR - normal directory listing * HDINIT - re-detect IDE devices. * INIT - initialize memory * KILL - disable cartridge * LL - long directory listing with timestamps, and file size in bytes. * MAN - start file manager * MKDIR - create directory * RM - remove file or directory '''File manager''' It can be used to navigate around directories, start programs, copy/rename/delete files, create directories, and execute plugins to operate on files. Recursive file copy was only added in 0.898b, and in rare cases it does not work. '''Monitor''' The monitor is almost exactly the Final cartridge monitor in IDEDOS 0.89. Only standard 6502 opcodes are available. The commands are: * A - Assemble instructions * B - Bank switch * C - Compare memory areas * D - Disassemble from address * EC - Edit char * ES - Edit sprite * F - Fill memory area * G - Start execution at address * H - Search pattern * I - PETSCII display from address * L - Load memory area * M - Memory list * O - Bank switch * P - Print * R - Show registers * S - Save memory area * T - Transfer memory area * X - Exit monitor * @ - Disk command * # - Convert to hexadecimal * $ - Convert to decimal * *r - Read block from floppy drive * *w - Write block 